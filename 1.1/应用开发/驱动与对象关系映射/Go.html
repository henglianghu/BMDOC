
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="贝格迈思数据库使用手册">
      
      
      
      
        <link rel="prev" href="Java.html">
      
      
        <link rel="next" href="Python.html">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Go - 手册</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mo" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->


  


<!-- Header -->
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="页眉"
  >

    <!-- Link to home -->
    <a
      href="../../index.html"
      title="手册"
      class="md-header__button md-logo"
      aria-label="手册"
      data-md-component="logo"
    >
      
  <img src="../../assets/new-logo.png" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            手册
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Go
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette toggle -->
    
      
    

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
      <div class="md-header__source">
        <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="手册" class="md-nav__button md-logo" aria-label="手册" data-md-component="logo">
      
  <img src="../../assets/new-logo.png" alt="logo">

    </a>
    手册
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AiSQL简介
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    快速上手
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    应用开发
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            应用开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/JAVA.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    构建应用
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%9E%84%E5%BB%BA%E5%85%A8%E5%B1%80%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    构建全局应用程序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%9E%84%E5%BB%BA%E5%A4%9A%E4%BA%91%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    构建多云应用程序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%B8%B8%E8%A7%81%E6%A8%A1%E5%BC%8F.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见模式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E5%AD%A6%E4%B9%A0%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    学习应用程序开发
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    最佳实践
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    驱动与对象关系映射
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            驱动与对象关系映射
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E6%A6%82%E8%BF%B0.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    概述
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="BSQL%E6%99%BA%E8%83%BD%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSQL智能驱动程序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Java.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Go
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Go.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Go
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    概述
  </a>
  
    <nav class="md-nav" aria-label="概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    支持的项目
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    先决条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    应用连接
  </a>
  
    <nav class="md-nav" aria-label="应用连接">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bsql" class="md-nav__link">
    BSQL
  </a>
  
    <nav class="md-nav" aria-label="BSQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bmdb-pgx" class="md-nav__link">
    BMDB PGX智能驱动程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgx" class="md-nav__link">
    PGX 驱动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pq" class="md-nav__link">
    PQ 驱动
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcql" class="md-nav__link">
    BCQL
  </a>
  
    <nav class="md-nav" aria-label="BCQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bmdb-go" class="md-nav__link">
    BMDB GO驱动
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orm" class="md-nav__link">
    使用ORM
  </a>
  
    <nav class="md-nav" aria-label="使用ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gorm-orm" class="md-nav__link">
    GORM ORM
  </a>
  
    <nav class="md-nav" aria-label="GORM ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crud" class="md-nav__link">
    CRUD 操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg-orm" class="md-nav__link">
    PG ORM
  </a>
  
    <nav class="md-nav" aria-label="PG ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crud_1" class="md-nav__link">
    CRUD 操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Node.js.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="C.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="C%2B%2B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="C%23.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C#
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Ruby.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%9C%9F%E5%AE%9E%E7%A4%BA%E4%BE%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    真实示例
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    服务质量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    云原生开发
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E9%A9%B1%E5%8A%A8%E5%92%8CORMs/JDBC_Drivers.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    驱动和ORMs
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三方工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../BSQL%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86%E6%B1%A0.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSQL连接管理池
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E9%83%A8%E7%BD%B2%E9%9B%86%E7%BE%A4/%E8%BD%AF%E7%A1%AC%E4%BB%B6%E7%8E%AF%E5%A2%83%E9%9C%80%E6%B1%82.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    部署集群
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../05-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据迁移
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93/%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    管理数据库
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../07-%E5%90%91%E9%87%8F%E7%89%B9%E6%80%A7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    向量特性
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../AI%E7%89%B9%E6%80%A7/%E6%A6%82%E8%BF%B0.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    AI特性
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    参考
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    概述
  </a>
  
    <nav class="md-nav" aria-label="概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    支持的项目
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    先决条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    应用连接
  </a>
  
    <nav class="md-nav" aria-label="应用连接">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bsql" class="md-nav__link">
    BSQL
  </a>
  
    <nav class="md-nav" aria-label="BSQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bmdb-pgx" class="md-nav__link">
    BMDB PGX智能驱动程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgx" class="md-nav__link">
    PGX 驱动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pq" class="md-nav__link">
    PQ 驱动
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcql" class="md-nav__link">
    BCQL
  </a>
  
    <nav class="md-nav" aria-label="BCQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bmdb-go" class="md-nav__link">
    BMDB GO驱动
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orm" class="md-nav__link">
    使用ORM
  </a>
  
    <nav class="md-nav" aria-label="使用ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gorm-orm" class="md-nav__link">
    GORM ORM
  </a>
  
    <nav class="md-nav" aria-label="GORM ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crud" class="md-nav__link">
    CRUD 操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg-orm" class="md-nav__link">
    PG ORM
  </a>
  
    <nav class="md-nav" aria-label="PG ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crud_1" class="md-nav__link">
    CRUD 操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/as599397086/BMDOC/edit/master/docs/应用开发/驱动与对象关系映射/Go.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/as599397086/BMDOC/raw/master/docs/应用开发/驱动与对象关系映射/Go.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>Go</h1>

<h2 id="_1"><strong>概述</strong><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2"><strong>支持的项目</strong><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>以下项目可用于使用BMDB  BSQL和BCQL API实现Golang应用程序。</p>
<table>
<thead>
<tr>
<th>驱动</th>
<th>版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>BMDB PGX Driver [推荐]</td>
<td>v4</td>
</tr>
<tr>
<td>PGX Driver</td>
<td>v4</td>
</tr>
<tr>
<td>PQ Driver</td>
<td>v1.10.2</td>
</tr>
<tr>
<td>BMDB Go Driver for BCQL</td>
<td>3.16.3</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>项目</th>
<th>APP 示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>GORM [推荐]</td>
<td>Hello World</td>
</tr>
<tr>
<td>GO-PG</td>
<td></td>
</tr>
</tbody>
</table>
<p>了解如何建立与BMDB 数据库的连接，并通过参考连接应用程序或使用ORM开始基本的CRUD操作。</p>
<p>有关参考文档，包括使用带SSL的项目，请参阅驱动程序和ORM参考页。</p>
<h3 id="_3"><strong>先决条件</strong><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>要为BMDB开发Golang应用程序，您需要以下内容：</p>
<ul>
<li>
<p>Go
  在系统上安装最新的Go（1.16或更高版本）。
  在终端中运行go --version以检查您的go版本。要安装Go，请访问Go下载。 </p>
</li>
<li>
<p>创建Go项目
  为了便于使用，请使用集成开发环境（IDE），如Visual Studio。要下载并安装Visual Studio，请访问Visual Studio下载页面。 </p>
</li>
</ul>
<h2 id="_4"><strong>应用连接</strong><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="bsql"><strong>BSQL</strong><a class="headerlink" href="#bsql" title="Permanent link">&para;</a></h3>
<h4 id="bmdb-pgx">BMDB PGX智能驱动程序<a class="headerlink" href="#bmdb-pgx" title="Permanent link">&para;</a></h4>
<p>BMDB PGX智能驱动程序是基于jackc/pgx的BSQL Go驱动程序，具有额外的连接负载平衡功能。</p>
<p>驱动程序与应用程序提供的第一个接触点进行初始连接，以发现集群中的所有节点。如果驱动程序发现过时的信息（默认情况下，超过5分钟），它会在每次新的连接尝试时刷新活动端点的列表。<br />
3.7.4.2.1.1.1. <em>CRUD操作</em></p>
<p>以下部分演示如何使用BMDB PGX智能驱动程序API执行Go应用程序开发所需的常见任务。</p>
<p>若要开始构建应用程序，请确保满足先决条件。</p>
<p><strong>步骤1</strong>：导入驱动程序包 </p>
<p>通过在Go代码中添加以下导入语句来导入BMDB PGX驱动程序包： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>import (
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>  &quot;gitlab.bigmath.com/bigmath/pgx/v4&quot;
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a>)
</span></code></pre></div></td></tr></table></div>
<p>要在本地安装程序包，请运行以下命令：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a>mkdir bm-pgx
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a>cd bm-pgx
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a>go mod init hello
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a>go get gitlab.bigmath.com/bigmath/pgx/v4
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a>go get gitlab.bigmath.com/bigmath/pgx/v4/pgxpool # Install pgxpool package if you write your application with pgxpool.Connect().
</span></code></pre></div></td></tr></table></div>
<p>也可以选择导入pgxpool包。请参阅使用pgxpool API了解更多信息。</p>
<p><strong>步骤2</strong>：设置数据库连接 </p>
<p>Go应用程序可以使用pgx.Connect()和pgxpool.Connect()函数连接到BMDB数据库。pgx包包括使用BMDB所需的所有通用函数或结构。
使用pgx.Connect()方法或pgxpool.Connect()方法为BMDB数据库创建一个连接对象。这可以用于对数据库执行DDLs 和DMLs 。
下表描述了连接所需的连接参数，包括用于统一和拓扑负载平衡的智能驱动程序参数。 </p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>host</td>
<td>BMDB实例的主机名.可以输入多个地址</td>
<td>localhost</td>
</tr>
<tr>
<td>port</td>
<td>BSQL监听端口</td>
<td>2521</td>
</tr>
<tr>
<td>user</td>
<td>连接到数据库的用户名</td>
<td>bigmath</td>
</tr>
<tr>
<td>password</td>
<td>用户密码</td>
<td>bigmath</td>
</tr>
<tr>
<td>dbname</td>
<td>数据库名</td>
<td>bigmath</td>
</tr>
<tr>
<td>load_balance</td>
<td>均匀负载平衡</td>
<td>默认为上游驱动程序行为，除非设置为“true”</td>
</tr>
<tr>
<td>bm_servers_refresh_interval</td>
<td>如果load_balance为true，则刷新服务器列表的间隔（以秒为单位）</td>
<td>300</td>
</tr>
<tr>
<td>topology_keys</td>
<td>拓扑感知负载平衡</td>
<td>如果load_balance为true，则使用统一负载平衡，除非设置为cloud.region.zone形式的逗号分隔地理位置。</td>
</tr>
</tbody>
</table>
<p>以下是用于连接到具有统一负载平衡的BMDB的连接字符串示例： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>postgres://username:password@localhost:2521/database_name?load_balance=true&amp; \
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>    bm_servers_refresh_interval=240
</span></code></pre></div></td></tr></table></div>
<p>以下是使用连接参数连接到BMDB的代码片段：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>baseUrl := fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s&quot;,
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>                    user, password, host, port, dbname)
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a>url := fmt.Sprintf(&quot;%s?load_balance=true&amp;bm_servers_refresh_interval=240&quot;, baseUrl)
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a>conn, err := pgx.Connect(context.Background(), url)
</span></code></pre></div></td></tr></table></div>
<p>以下是一个示例连接字符串，用于连接到具有拓扑感知负载平衡的BMDB，并包括一个回退位置： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>postgres://username:password@localhost:2521/database_name?load_balance=true&amp;topology_keys=cloud1.region1.zone1:1,cloud1.region1.zone2:2
</span></code></pre></div></td></tr></table></div>
<p>以下是使用拓扑感知负载平衡连接到BMDB的代码片段： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a>baseUrl := fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s&quot;,
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>                    user, password, host, port, dbname)
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>url = fmt.Sprintf(&quot;%s?load_balance=true&amp;topology_keys=cloud1.datacenter1.rack1&quot;, baseUrl)
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a>conn, err := pgx.Connect(context.Background(), url)
</span></code></pre></div></td></tr></table></div>
<p>在驱动程序建立初始连接后，它会从集群中获取可用服务器的列表，并在这些服务器上负载平衡后续的连接请求。</p>
<p>1）使用多个地址</p>
<p>您可以在连接字符串中指定多个主机，以便在初始连接期间提供备用选项，以防主地址出现故障。 </p>
<p>使用逗号分隔地址，如下所示：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a>postgres://username:password@host1:2521,host2:2521,host3:2521/database_name?load_balance=true
</span></code></pre></div></td></tr></table></div>
<p>以下是使用多个主机连接到BMDB的代码片段：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a>url := fmt.Sprintf(&quot;postgres://%s:%s@%s:%d&quot;,
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>        dbUser, dbPassword, host1, port)
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a>    if host2 != &quot;&quot; {
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>        url += fmt.Sprintf(&quot;,%s:%d&quot;, host2, port)
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>    }
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a>    if host3 != &quot;&quot; {
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a>        url += fmt.Sprintf(&quot;,%s:%d&quot;, host3, port)
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a>    }
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a>    url += fmt.Sprintf(&quot;/%s&quot;, dbName)
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a>    if sslMode != &quot;&quot; {
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15"></a>        url += fmt.Sprintf(&quot;?sslmode=%s&quot;, sslMode)
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16"></a>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17"></a>        if sslRootCert != &quot;&quot; {
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18"></a>            url += fmt.Sprintf(&quot;&amp;sslrootcert=%s&quot;, sslRootCert)
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19"></a>        }
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20"></a>    }
</span></code></pre></div></td></tr></table></div>
<p>主机仅在初始连接尝试期间使用。如果驱动程序连接时第一台主机关闭，则驱动程序会尝试连接到字符串中的下一台主机，依此类推。 </p>
<p>2）使用SSL</p>
<p>对于BMDB托管集群，或启用了SSL/TLS的BMDB数据库集群，请在客户端设置以下与SSL相关的环境变量。客户端身份验证默认启用SSL/TLS。有关默认模式和支持的模式，请参阅配置SSL/TLS。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>export PGSSLMODE=verify-ca
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>export PGSSLROOTCERT=~/root.crt  # Here, the CA certificate file is downloaded as `root.crt` under home directory. Modify your path accordingly.
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>环境变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>PGSSLMODE</td>
<td>用于连接的SSL模式</td>
</tr>
<tr>
<td>PGSSLROOTCERT</td>
<td>计算机上根证书的路径</td>
</tr>
</tbody>
</table>
<p><strong>步骤3</strong>：使用pgx.Connect()编写应用程序</p>
<p>创建一个名为QuickStart.go的文件，并在其中添加以下内容： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">  1</a></span>
<span class="normal"><a href="#__codelineno-9-2">  2</a></span>
<span class="normal"><a href="#__codelineno-9-3">  3</a></span>
<span class="normal"><a href="#__codelineno-9-4">  4</a></span>
<span class="normal"><a href="#__codelineno-9-5">  5</a></span>
<span class="normal"><a href="#__codelineno-9-6">  6</a></span>
<span class="normal"><a href="#__codelineno-9-7">  7</a></span>
<span class="normal"><a href="#__codelineno-9-8">  8</a></span>
<span class="normal"><a href="#__codelineno-9-9">  9</a></span>
<span class="normal"><a href="#__codelineno-9-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-9-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-9-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-9-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-9-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-9-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-9-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-9-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-9-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-9-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-9-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-9-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-9-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-9-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-9-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-9-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-9-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-9-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-9-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-9-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-9-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-9-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-9-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-9-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-9-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-9-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-9-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-9-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-9-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-9-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-9-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-9-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-9-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-9-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-9-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-9-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-9-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-9-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-9-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-9-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-9-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-9-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-9-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-9-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-9-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-9-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-9-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-9-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-9-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-9-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-9-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-9-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-9-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-9-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-9-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-9-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-9-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-9-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-9-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-9-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-9-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-9-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-9-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-9-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-9-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-9-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-9-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-9-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-9-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-9-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-9-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-9-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-9-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-9-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-9-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-9-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-9-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-9-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-9-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-9-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-9-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-9-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-9-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-9-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-9-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-9-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-9-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-9-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-9-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-9-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-9-100">100</a></span>
<span class="normal"><a href="#__codelineno-9-101">101</a></span>
<span class="normal"><a href="#__codelineno-9-102">102</a></span>
<span class="normal"><a href="#__codelineno-9-103">103</a></span>
<span class="normal"><a href="#__codelineno-9-104">104</a></span>
<span class="normal"><a href="#__codelineno-9-105">105</a></span>
<span class="normal"><a href="#__codelineno-9-106">106</a></span>
<span class="normal"><a href="#__codelineno-9-107">107</a></span>
<span class="normal"><a href="#__codelineno-9-108">108</a></span>
<span class="normal"><a href="#__codelineno-9-109">109</a></span>
<span class="normal"><a href="#__codelineno-9-110">110</a></span>
<span class="normal"><a href="#__codelineno-9-111">111</a></span>
<span class="normal"><a href="#__codelineno-9-112">112</a></span>
<span class="normal"><a href="#__codelineno-9-113">113</a></span>
<span class="normal"><a href="#__codelineno-9-114">114</a></span>
<span class="normal"><a href="#__codelineno-9-115">115</a></span>
<span class="normal"><a href="#__codelineno-9-116">116</a></span>
<span class="normal"><a href="#__codelineno-9-117">117</a></span>
<span class="normal"><a href="#__codelineno-9-118">118</a></span>
<span class="normal"><a href="#__codelineno-9-119">119</a></span>
<span class="normal"><a href="#__codelineno-9-120">120</a></span>
<span class="normal"><a href="#__codelineno-9-121">121</a></span>
<span class="normal"><a href="#__codelineno-9-122">122</a></span>
<span class="normal"><a href="#__codelineno-9-123">123</a></span>
<span class="normal"><a href="#__codelineno-9-124">124</a></span>
<span class="normal"><a href="#__codelineno-9-125">125</a></span>
<span class="normal"><a href="#__codelineno-9-126">126</a></span>
<span class="normal"><a href="#__codelineno-9-127">127</a></span>
<span class="normal"><a href="#__codelineno-9-128">128</a></span>
<span class="normal"><a href="#__codelineno-9-129">129</a></span>
<span class="normal"><a href="#__codelineno-9-130">130</a></span>
<span class="normal"><a href="#__codelineno-9-131">131</a></span>
<span class="normal"><a href="#__codelineno-9-132">132</a></span>
<span class="normal"><a href="#__codelineno-9-133">133</a></span>
<span class="normal"><a href="#__codelineno-9-134">134</a></span>
<span class="normal"><a href="#__codelineno-9-135">135</a></span>
<span class="normal"><a href="#__codelineno-9-136">136</a></span>
<span class="normal"><a href="#__codelineno-9-137">137</a></span>
<span class="normal"><a href="#__codelineno-9-138">138</a></span>
<span class="normal"><a href="#__codelineno-9-139">139</a></span>
<span class="normal"><a href="#__codelineno-9-140">140</a></span>
<span class="normal"><a href="#__codelineno-9-141">141</a></span>
<span class="normal"><a href="#__codelineno-9-142">142</a></span>
<span class="normal"><a href="#__codelineno-9-143">143</a></span>
<span class="normal"><a href="#__codelineno-9-144">144</a></span>
<span class="normal"><a href="#__codelineno-9-145">145</a></span>
<span class="normal"><a href="#__codelineno-9-146">146</a></span>
<span class="normal"><a href="#__codelineno-9-147">147</a></span>
<span class="normal"><a href="#__codelineno-9-148">148</a></span>
<span class="normal"><a href="#__codelineno-9-149">149</a></span>
<span class="normal"><a href="#__codelineno-9-150">150</a></span>
<span class="normal"><a href="#__codelineno-9-151">151</a></span>
<span class="normal"><a href="#__codelineno-9-152">152</a></span>
<span class="normal"><a href="#__codelineno-9-153">153</a></span>
<span class="normal"><a href="#__codelineno-9-154">154</a></span>
<span class="normal"><a href="#__codelineno-9-155">155</a></span>
<span class="normal"><a href="#__codelineno-9-156">156</a></span>
<span class="normal"><a href="#__codelineno-9-157">157</a></span>
<span class="normal"><a href="#__codelineno-9-158">158</a></span>
<span class="normal"><a href="#__codelineno-9-159">159</a></span>
<span class="normal"><a href="#__codelineno-9-160">160</a></span>
<span class="normal"><a href="#__codelineno-9-161">161</a></span>
<span class="normal"><a href="#__codelineno-9-162">162</a></span>
<span class="normal"><a href="#__codelineno-9-163">163</a></span>
<span class="normal"><a href="#__codelineno-9-164">164</a></span>
<span class="normal"><a href="#__codelineno-9-165">165</a></span>
<span class="normal"><a href="#__codelineno-9-166">166</a></span>
<span class="normal"><a href="#__codelineno-9-167">167</a></span>
<span class="normal"><a href="#__codelineno-9-168">168</a></span>
<span class="normal"><a href="#__codelineno-9-169">169</a></span>
<span class="normal"><a href="#__codelineno-9-170">170</a></span>
<span class="normal"><a href="#__codelineno-9-171">171</a></span>
<span class="normal"><a href="#__codelineno-9-172">172</a></span>
<span class="normal"><a href="#__codelineno-9-173">173</a></span>
<span class="normal"><a href="#__codelineno-9-174">174</a></span>
<span class="normal"><a href="#__codelineno-9-175">175</a></span>
<span class="normal"><a href="#__codelineno-9-176">176</a></span>
<span class="normal"><a href="#__codelineno-9-177">177</a></span>
<span class="normal"><a href="#__codelineno-9-178">178</a></span>
<span class="normal"><a href="#__codelineno-9-179">179</a></span>
<span class="normal"><a href="#__codelineno-9-180">180</a></span>
<span class="normal"><a href="#__codelineno-9-181">181</a></span>
<span class="normal"><a href="#__codelineno-9-182">182</a></span>
<span class="normal"><a href="#__codelineno-9-183">183</a></span>
<span class="normal"><a href="#__codelineno-9-184">184</a></span>
<span class="normal"><a href="#__codelineno-9-185">185</a></span>
<span class="normal"><a href="#__codelineno-9-186">186</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>package main
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a>import (
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a>    &quot;bufio&quot;
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a>    &quot;context&quot;
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a>    &quot;fmt&quot;
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7"></a>    &quot;log&quot;
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8"></a>    &quot;os&quot;
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9"></a>    &quot;strconv&quot;
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10"></a>    &quot;time&quot;
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11"></a>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12"></a>    &quot;gitlab.bigmath.com/bigmath/pgx/v4&quot;
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13"></a>)
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14"></a>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15"></a>const (
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16"></a>    host     = &quot;localhost&quot;
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17"></a>    port     = 2521
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18"></a>    user     = &quot;bigmath&quot;
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19"></a>    password = &quot;bigmath&quot;
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20"></a>    dbname   = &quot;bigmath&quot;
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21"></a>    numconns = 12
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22"></a>)
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23"></a>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24"></a>var connCloseChan chan int = make(chan int)
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25"></a>var baseUrl string = fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s&quot;,
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26"></a>    user, password, host, port, dbname)
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28"></a>func main() {
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29"></a>    // Create a table and insert a row
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30"></a>    url := fmt.Sprintf(&quot;%s?load_balance=true&quot;, baseUrl)
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31"></a>    fmt.Printf(&quot;Connection url: %s\n&quot;, url)
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32"></a>    createTable(url)
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33"></a>    printAZInfo()
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34"></a>    pause()
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35"></a>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36"></a>    fmt.Println(&quot;---- Demonstrating uniform (cluster-aware) load balancing ----&quot;)
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37"></a>    executeQueries(url)
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38"></a>    fmt.Println(&quot;You can verify the connection counts on http://127.0.0.1:8100/rpcz and similar urls for other servers.&quot;)
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39"></a>    pause()
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40"></a>    closeConns(numconns)
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41"></a>
</span><span id="__span-9-42"><a id="__codelineno-9-42" name="__codelineno-9-42"></a>    fmt.Println(&quot;---- Demonstrating topology-aware load balancing ----&quot;)
</span><span id="__span-9-43"><a id="__codelineno-9-43" name="__codelineno-9-43"></a>    url = fmt.Sprintf(&quot;%s?load_balance=true&amp;topology_keys=cloud1.datacenter1.rack1&quot;, baseUrl)
</span><span id="__span-9-44"><a id="__codelineno-9-44" name="__codelineno-9-44"></a>    fmt.Printf(&quot;Connection url: %s\n&quot;, url)
</span><span id="__span-9-45"><a id="__codelineno-9-45" name="__codelineno-9-45"></a>    executeQueries(url)
</span><span id="__span-9-46"><a id="__codelineno-9-46" name="__codelineno-9-46"></a>    pause()
</span><span id="__span-9-47"><a id="__codelineno-9-47" name="__codelineno-9-47"></a>    closeConns(numconns)
</span><span id="__span-9-48"><a id="__codelineno-9-48" name="__codelineno-9-48"></a>
</span><span id="__span-9-49"><a id="__codelineno-9-49" name="__codelineno-9-49"></a>    fmt.Println(&quot;Closing the application ...&quot;)
</span><span id="__span-9-50"><a id="__codelineno-9-50" name="__codelineno-9-50"></a>}
</span><span id="__span-9-51"><a id="__codelineno-9-51" name="__codelineno-9-51"></a>
</span><span id="__span-9-52"><a id="__codelineno-9-52" name="__codelineno-9-52"></a>func closeConns(num int) {
</span><span id="__span-9-53"><a id="__codelineno-9-53" name="__codelineno-9-53"></a>    fmt.Printf(&quot;Closing %d connections ...\n&quot;, num)
</span><span id="__span-9-54"><a id="__codelineno-9-54" name="__codelineno-9-54"></a>    for i := 0; i &lt; num; i++ {
</span><span id="__span-9-55"><a id="__codelineno-9-55" name="__codelineno-9-55"></a>        connCloseChan &lt;- i
</span><span id="__span-9-56"><a id="__codelineno-9-56" name="__codelineno-9-56"></a>    }
</span><span id="__span-9-57"><a id="__codelineno-9-57" name="__codelineno-9-57"></a>}
</span><span id="__span-9-58"><a id="__codelineno-9-58" name="__codelineno-9-58"></a>
</span><span id="__span-9-59"><a id="__codelineno-9-59" name="__codelineno-9-59"></a>func pause() {
</span><span id="__span-9-60"><a id="__codelineno-9-60" name="__codelineno-9-60"></a>    reader := bufio.NewReader(os.Stdin)
</span><span id="__span-9-61"><a id="__codelineno-9-61" name="__codelineno-9-61"></a>    fmt.Print(&quot;\nPress Enter/return to proceed: &quot;)
</span><span id="__span-9-62"><a id="__codelineno-9-62" name="__codelineno-9-62"></a>    reader.ReadString(&#39;\n&#39;)
</span><span id="__span-9-63"><a id="__codelineno-9-63" name="__codelineno-9-63"></a>}
</span><span id="__span-9-64"><a id="__codelineno-9-64" name="__codelineno-9-64"></a>
</span><span id="__span-9-65"><a id="__codelineno-9-65" name="__codelineno-9-65"></a>func createTable(url string) {
</span><span id="__span-9-66"><a id="__codelineno-9-66" name="__codelineno-9-66"></a>    conn, err := pgx.Connect(context.Background(), url)
</span><span id="__span-9-67"><a id="__codelineno-9-67" name="__codelineno-9-67"></a>    if err != nil {
</span><span id="__span-9-68"><a id="__codelineno-9-68" name="__codelineno-9-68"></a>        fmt.Fprintf(os.Stderr, &quot;Unable to connect to database: %v\n&quot;, err)
</span><span id="__span-9-69"><a id="__codelineno-9-69" name="__codelineno-9-69"></a>        os.Exit(1)
</span><span id="__span-9-70"><a id="__codelineno-9-70" name="__codelineno-9-70"></a>    }
</span><span id="__span-9-71"><a id="__codelineno-9-71" name="__codelineno-9-71"></a>    defer conn.Close(context.Background())
</span><span id="__span-9-72"><a id="__codelineno-9-72" name="__codelineno-9-72"></a>
</span><span id="__span-9-73"><a id="__codelineno-9-73" name="__codelineno-9-73"></a>    var dropStmt = `DROP TABLE IF EXISTS employee`
</span><span id="__span-9-74"><a id="__codelineno-9-74" name="__codelineno-9-74"></a>    _, err = conn.Exec(context.Background(), dropStmt)
</span><span id="__span-9-75"><a id="__codelineno-9-75" name="__codelineno-9-75"></a>    if err != nil {
</span><span id="__span-9-76"><a id="__codelineno-9-76" name="__codelineno-9-76"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for drop table failed: %v\n&quot;, err)
</span><span id="__span-9-77"><a id="__codelineno-9-77" name="__codelineno-9-77"></a>    }
</span><span id="__span-9-78"><a id="__codelineno-9-78" name="__codelineno-9-78"></a>    // The `conn.Exec()` function also returns an `error` object which,
</span><span id="__span-9-79"><a id="__codelineno-9-79" name="__codelineno-9-79"></a>    // if not `nil`, needs to be handled in your code.
</span><span id="__span-9-80"><a id="__codelineno-9-80" name="__codelineno-9-80"></a>    var createStmt = `CREATE TABLE employee (id int PRIMARY KEY,
</span><span id="__span-9-81"><a id="__codelineno-9-81" name="__codelineno-9-81"></a>                                             name varchar,
</span><span id="__span-9-82"><a id="__codelineno-9-82" name="__codelineno-9-82"></a>                                             age int,
</span><span id="__span-9-83"><a id="__codelineno-9-83" name="__codelineno-9-83"></a>                                             language varchar)`
</span><span id="__span-9-84"><a id="__codelineno-9-84" name="__codelineno-9-84"></a>    _, err = conn.Exec(context.Background(), createStmt)
</span><span id="__span-9-85"><a id="__codelineno-9-85" name="__codelineno-9-85"></a>    if err != nil {
</span><span id="__span-9-86"><a id="__codelineno-9-86" name="__codelineno-9-86"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for create table failed: %v\n&quot;, err)
</span><span id="__span-9-87"><a id="__codelineno-9-87" name="__codelineno-9-87"></a>    }
</span><span id="__span-9-88"><a id="__codelineno-9-88" name="__codelineno-9-88"></a>    fmt.Println(&quot;Created table employee&quot;)
</span><span id="__span-9-89"><a id="__codelineno-9-89" name="__codelineno-9-89"></a>
</span><span id="__span-9-90"><a id="__codelineno-9-90" name="__codelineno-9-90"></a>    // Insert data using the conn.Exec() function.
</span><span id="__span-9-91"><a id="__codelineno-9-91" name="__codelineno-9-91"></a>    var insertStmt string = &quot;INSERT INTO employee(id, name, age, language)&quot; +
</span><span id="__span-9-92"><a id="__codelineno-9-92" name="__codelineno-9-92"></a>        &quot; VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)&quot;
</span><span id="__span-9-93"><a id="__codelineno-9-93" name="__codelineno-9-93"></a>    _, err = conn.Exec(context.Background(), insertStmt)
</span><span id="__span-9-94"><a id="__codelineno-9-94" name="__codelineno-9-94"></a>    if err != nil {
</span><span id="__span-9-95"><a id="__codelineno-9-95" name="__codelineno-9-95"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for create table failed: %v\n&quot;, err)
</span><span id="__span-9-96"><a id="__codelineno-9-96" name="__codelineno-9-96"></a>    }
</span><span id="__span-9-97"><a id="__codelineno-9-97" name="__codelineno-9-97"></a>    // The pgx driver automatically prepares and caches statements by default, so you don&#39;t have to.
</span><span id="__span-9-98"><a id="__codelineno-9-98" name="__codelineno-9-98"></a>
</span><span id="__span-9-99"><a id="__codelineno-9-99" name="__codelineno-9-99"></a>    // Query data using the conn.Query() function with the SELECT statements.
</span><span id="__span-9-100"><a id="__codelineno-9-100" name="__codelineno-9-100"></a>    var name, language string
</span><span id="__span-9-101"><a id="__codelineno-9-101" name="__codelineno-9-101"></a>    var age int
</span><span id="__span-9-102"><a id="__codelineno-9-102" name="__codelineno-9-102"></a>    rows, err := conn.Query(context.Background(), &quot;SELECT name, age, language FROM employee WHERE id = 1&quot;)
</span><span id="__span-9-103"><a id="__codelineno-9-103" name="__codelineno-9-103"></a>    if err != nil {
</span><span id="__span-9-104"><a id="__codelineno-9-104" name="__codelineno-9-104"></a>        log.Fatal(err)
</span><span id="__span-9-105"><a id="__codelineno-9-105" name="__codelineno-9-105"></a>    }
</span><span id="__span-9-106"><a id="__codelineno-9-106" name="__codelineno-9-106"></a>    defer rows.Close()
</span><span id="__span-9-107"><a id="__codelineno-9-107" name="__codelineno-9-107"></a>    // Results are returned in pgx.Rows which can be iterated using the pgx.Rows.next() method.
</span><span id="__span-9-108"><a id="__codelineno-9-108" name="__codelineno-9-108"></a>    for rows.Next() {
</span><span id="__span-9-109"><a id="__codelineno-9-109" name="__codelineno-9-109"></a>        // Read the data using pgx.rows.Scan().
</span><span id="__span-9-110"><a id="__codelineno-9-110" name="__codelineno-9-110"></a>        err := rows.Scan(&amp;name, &amp;age, &amp;language)
</span><span id="__span-9-111"><a id="__codelineno-9-111" name="__codelineno-9-111"></a>        if err != nil {
</span><span id="__span-9-112"><a id="__codelineno-9-112" name="__codelineno-9-112"></a>            log.Fatal(err)
</span><span id="__span-9-113"><a id="__codelineno-9-113" name="__codelineno-9-113"></a>        }
</span><span id="__span-9-114"><a id="__codelineno-9-114" name="__codelineno-9-114"></a>        // log.Printf(&quot;Row[%s, %d, %s]\n&quot;, name, age, language)
</span><span id="__span-9-115"><a id="__codelineno-9-115" name="__codelineno-9-115"></a>    }
</span><span id="__span-9-116"><a id="__codelineno-9-116" name="__codelineno-9-116"></a>    err = rows.Err()
</span><span id="__span-9-117"><a id="__codelineno-9-117" name="__codelineno-9-117"></a>    if err != nil {
</span><span id="__span-9-118"><a id="__codelineno-9-118" name="__codelineno-9-118"></a>        log.Fatal(err)
</span><span id="__span-9-119"><a id="__codelineno-9-119" name="__codelineno-9-119"></a>    }
</span><span id="__span-9-120"><a id="__codelineno-9-120" name="__codelineno-9-120"></a>}
</span><span id="__span-9-121"><a id="__codelineno-9-121" name="__codelineno-9-121"></a>
</span><span id="__span-9-122"><a id="__codelineno-9-122" name="__codelineno-9-122"></a>func executeQueries(url string) {
</span><span id="__span-9-123"><a id="__codelineno-9-123" name="__codelineno-9-123"></a>    fmt.Printf(&quot;Creating %d connections ...\n&quot;, numconns)
</span><span id="__span-9-124"><a id="__codelineno-9-124" name="__codelineno-9-124"></a>    for i := 0; i &lt; numconns; i++ {
</span><span id="__span-9-125"><a id="__codelineno-9-125" name="__codelineno-9-125"></a>        go executeQuery(&quot;GO Routine &quot;+strconv.Itoa(i), url, connCloseChan)
</span><span id="__span-9-126"><a id="__codelineno-9-126" name="__codelineno-9-126"></a>    }
</span><span id="__span-9-127"><a id="__codelineno-9-127" name="__codelineno-9-127"></a>    time.Sleep(5 * time.Second)
</span><span id="__span-9-128"><a id="__codelineno-9-128" name="__codelineno-9-128"></a>    printHostLoad()
</span><span id="__span-9-129"><a id="__codelineno-9-129" name="__codelineno-9-129"></a>}
</span><span id="__span-9-130"><a id="__codelineno-9-130" name="__codelineno-9-130"></a>
</span><span id="__span-9-131"><a id="__codelineno-9-131" name="__codelineno-9-131"></a>func executeQuery(grid string, url string, ccChan chan int) {
</span><span id="__span-9-132"><a id="__codelineno-9-132" name="__codelineno-9-132"></a>    conn, err := pgx.Connect(context.Background(), url)
</span><span id="__span-9-133"><a id="__codelineno-9-133" name="__codelineno-9-133"></a>    if err != nil {
</span><span id="__span-9-134"><a id="__codelineno-9-134" name="__codelineno-9-134"></a>        fmt.Fprintf(os.Stderr, &quot;[%s] Unable to connect to database: %v\n&quot;, grid, err)
</span><span id="__span-9-135"><a id="__codelineno-9-135" name="__codelineno-9-135"></a>        os.Exit(1)
</span><span id="__span-9-136"><a id="__codelineno-9-136" name="__codelineno-9-136"></a>    }
</span><span id="__span-9-137"><a id="__codelineno-9-137" name="__codelineno-9-137"></a>
</span><span id="__span-9-138"><a id="__codelineno-9-138" name="__codelineno-9-138"></a>    // Read from the table.
</span><span id="__span-9-139"><a id="__codelineno-9-139" name="__codelineno-9-139"></a>    var name, language string
</span><span id="__span-9-140"><a id="__codelineno-9-140" name="__codelineno-9-140"></a>    var age int
</span><span id="__span-9-141"><a id="__codelineno-9-141" name="__codelineno-9-141"></a>    rows, err := conn.Query(context.Background(), &quot;SELECT name, age, language FROM employee WHERE id = 1&quot;)
</span><span id="__span-9-142"><a id="__codelineno-9-142" name="__codelineno-9-142"></a>    if err != nil {
</span><span id="__span-9-143"><a id="__codelineno-9-143" name="__codelineno-9-143"></a>        log.Fatal(err)
</span><span id="__span-9-144"><a id="__codelineno-9-144" name="__codelineno-9-144"></a>    }
</span><span id="__span-9-145"><a id="__codelineno-9-145" name="__codelineno-9-145"></a>    defer rows.Close()
</span><span id="__span-9-146"><a id="__codelineno-9-146" name="__codelineno-9-146"></a>    fstr := fmt.Sprintf(&quot;[%s] Query for id=1 returned: &quot;, grid)
</span><span id="__span-9-147"><a id="__codelineno-9-147" name="__codelineno-9-147"></a>    for rows.Next() {
</span><span id="__span-9-148"><a id="__codelineno-9-148" name="__codelineno-9-148"></a>        err := rows.Scan(&amp;name, &amp;age, &amp;language)
</span><span id="__span-9-149"><a id="__codelineno-9-149" name="__codelineno-9-149"></a>        if err != nil {
</span><span id="__span-9-150"><a id="__codelineno-9-150" name="__codelineno-9-150"></a>            log.Fatal(err)
</span><span id="__span-9-151"><a id="__codelineno-9-151" name="__codelineno-9-151"></a>        }
</span><span id="__span-9-152"><a id="__codelineno-9-152" name="__codelineno-9-152"></a>        fstr = fstr + fmt.Sprintf(&quot; Row[%s, %d, %s]&quot;, name, age, language)
</span><span id="__span-9-153"><a id="__codelineno-9-153" name="__codelineno-9-153"></a>    }
</span><span id="__span-9-154"><a id="__codelineno-9-154" name="__codelineno-9-154"></a>    err = rows.Err()
</span><span id="__span-9-155"><a id="__codelineno-9-155" name="__codelineno-9-155"></a>    if err != nil {
</span><span id="__span-9-156"><a id="__codelineno-9-156" name="__codelineno-9-156"></a>        log.Fatal(err)
</span><span id="__span-9-157"><a id="__codelineno-9-157" name="__codelineno-9-157"></a>    }
</span><span id="__span-9-158"><a id="__codelineno-9-158" name="__codelineno-9-158"></a>    // log.Println(fstr)
</span><span id="__span-9-159"><a id="__codelineno-9-159" name="__codelineno-9-159"></a>    _, ok := &lt;-ccChan
</span><span id="__span-9-160"><a id="__codelineno-9-160" name="__codelineno-9-160"></a>    if ok {
</span><span id="__span-9-161"><a id="__codelineno-9-161" name="__codelineno-9-161"></a>        conn.Close(context.Background())
</span><span id="__span-9-162"><a id="__codelineno-9-162" name="__codelineno-9-162"></a>    }
</span><span id="__span-9-163"><a id="__codelineno-9-163" name="__codelineno-9-163"></a>}
</span><span id="__span-9-164"><a id="__codelineno-9-164" name="__codelineno-9-164"></a>
</span><span id="__span-9-165"><a id="__codelineno-9-165" name="__codelineno-9-165"></a>func printHostLoad() {
</span><span id="__span-9-166"><a id="__codelineno-9-166" name="__codelineno-9-166"></a>    for k, cli := range pgx.GetHostLoad() {
</span><span id="__span-9-167"><a id="__codelineno-9-167" name="__codelineno-9-167"></a>        str := &quot;Current load on cluster (&quot; + k + &quot;): &quot;
</span><span id="__span-9-168"><a id="__codelineno-9-168" name="__codelineno-9-168"></a>        for h, c := range cli {
</span><span id="__span-9-169"><a id="__codelineno-9-169" name="__codelineno-9-169"></a>            str = str + fmt.Sprintf(&quot;\n%-30s:%5d&quot;, h, c)
</span><span id="__span-9-170"><a id="__codelineno-9-170" name="__codelineno-9-170"></a>        }
</span><span id="__span-9-171"><a id="__codelineno-9-171" name="__codelineno-9-171"></a>        fmt.Println(str)
</span><span id="__span-9-172"><a id="__codelineno-9-172" name="__codelineno-9-172"></a>    }
</span><span id="__span-9-173"><a id="__codelineno-9-173" name="__codelineno-9-173"></a>}
</span><span id="__span-9-174"><a id="__codelineno-9-174" name="__codelineno-9-174"></a>
</span><span id="__span-9-175"><a id="__codelineno-9-175" name="__codelineno-9-175"></a>func printAZInfo() {
</span><span id="__span-9-176"><a id="__codelineno-9-176" name="__codelineno-9-176"></a>    for k, zl := range pgx.GetAZInfo() {
</span><span id="__span-9-177"><a id="__codelineno-9-177" name="__codelineno-9-177"></a>        str := &quot;Placement info details of cluster (&quot; + k + &quot;): &quot;
</span><span id="__span-9-178"><a id="__codelineno-9-178" name="__codelineno-9-178"></a>        for z, hosts := range zl {
</span><span id="__span-9-179"><a id="__codelineno-9-179" name="__codelineno-9-179"></a>            str = str + fmt.Sprintf(&quot;\n    AZ [%s]: &quot;, z)
</span><span id="__span-9-180"><a id="__codelineno-9-180" name="__codelineno-9-180"></a>            for _, s := range hosts {
</span><span id="__span-9-181"><a id="__codelineno-9-181" name="__codelineno-9-181"></a>                str = str + fmt.Sprintf(&quot;%s, &quot;, s)
</span><span id="__span-9-182"><a id="__codelineno-9-182" name="__codelineno-9-182"></a>            }
</span><span id="__span-9-183"><a id="__codelineno-9-183" name="__codelineno-9-183"></a>        }
</span><span id="__span-9-184"><a id="__codelineno-9-184" name="__codelineno-9-184"></a>        fmt.Println(str)
</span><span id="__span-9-185"><a id="__codelineno-9-185" name="__codelineno-9-185"></a>    }
</span><span id="__span-9-186"><a id="__codelineno-9-186" name="__codelineno-9-186"></a>}
</span></code></pre></div></td></tr></table></div>
<ul>
<li>常量值被设置为BMDB本地安装的默认值。</li>
</ul>
<p>使用以下命令运行项目QuickStartApp.go：  </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a>go run QuickStartApp.go
</span></code></pre></div></td></tr></table></div>
<p>此程序希望您的输入继续执行应用程序步骤。</p>
<p>对于具有三个服务器的本地集群，所有服务器的位置信息都为cloud1.datacenter1.rack1，您应该看到以下输出： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span>
<span class="normal"><a href="#__codelineno-11-22">22</a></span>
<span class="normal"><a href="#__codelineno-11-23">23</a></span>
<span class="normal"><a href="#__codelineno-11-24">24</a></span>
<span class="normal"><a href="#__codelineno-11-25">25</a></span>
<span class="normal"><a href="#__codelineno-11-26">26</a></span>
<span class="normal"><a href="#__codelineno-11-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a>Connection url: postgres://bigmath:bigmath@localhost:2521/bigmath?load_balance=true
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>Created table employee
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a>Placement info details of cluster (127.0.0.1):
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a>    AZ [cloud1.datacenter1.rack1]: 127.0.0.3, 127.0.0.2, 127.0.0.1,
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6"></a>Press Enter/return to proceed:
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7"></a>---- Demonstrating uniform (cluster-aware) load balancing ----
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8"></a>Creating 12 connections ...
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9"></a>Current load on cluster (127.0.0.1):
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10"></a>127.0.0.3                     :    4
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11"></a>127.0.0.2                     :    4
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12"></a>127.0.0.1                     :    4
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13"></a>You can verify the connection counts on http://127.0.0.1:8100/rpcz and similar urls for other servers.
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14"></a>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15"></a>Press Enter/return to proceed:
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16"></a>Closing 12 connections ...
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17"></a>---- Demonstrating topology-aware load balancing ----
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18"></a>Connection url: postgres://bigmath:bigmath@localhost:2521/bigmath?load_balance=true&amp;topology_keys=cloud1.datacenter1.rack1
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19"></a>Creating 12 connections ...
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20"></a>Current load on cluster (127.0.0.1):
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21"></a>127.0.0.1                     :    4
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22"></a>127.0.0.3                     :    4
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23"></a>127.0.0.2                     :    4
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24"></a>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25"></a>Press Enter/return to proceed:
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26"></a>Closing 12 connections ...
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27"></a>Closing the application ...
</span></code></pre></div></td></tr></table></div>
<p><strong>步骤4</strong>：使用pgxpool.Connect()编写应用程序</p>
<p>创建一个名为QuickStart2.go的文件，并在其中添加以下内容：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">  1</a></span>
<span class="normal"><a href="#__codelineno-12-2">  2</a></span>
<span class="normal"><a href="#__codelineno-12-3">  3</a></span>
<span class="normal"><a href="#__codelineno-12-4">  4</a></span>
<span class="normal"><a href="#__codelineno-12-5">  5</a></span>
<span class="normal"><a href="#__codelineno-12-6">  6</a></span>
<span class="normal"><a href="#__codelineno-12-7">  7</a></span>
<span class="normal"><a href="#__codelineno-12-8">  8</a></span>
<span class="normal"><a href="#__codelineno-12-9">  9</a></span>
<span class="normal"><a href="#__codelineno-12-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-12-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-12-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-12-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-12-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-12-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-12-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-12-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-12-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-12-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-12-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-12-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-12-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-12-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-12-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-12-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-12-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-12-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-12-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-12-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-12-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-12-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-12-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-12-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-12-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-12-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-12-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-12-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-12-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-12-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-12-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-12-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-12-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-12-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-12-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-12-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-12-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-12-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-12-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-12-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-12-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-12-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-12-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-12-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-12-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-12-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-12-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-12-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-12-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-12-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-12-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-12-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-12-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-12-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-12-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-12-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-12-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-12-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-12-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-12-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-12-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-12-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-12-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-12-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-12-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-12-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-12-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-12-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-12-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-12-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-12-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-12-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-12-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-12-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-12-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-12-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-12-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-12-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-12-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-12-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-12-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-12-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-12-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-12-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-12-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-12-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-12-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-12-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-12-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-12-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-12-100">100</a></span>
<span class="normal"><a href="#__codelineno-12-101">101</a></span>
<span class="normal"><a href="#__codelineno-12-102">102</a></span>
<span class="normal"><a href="#__codelineno-12-103">103</a></span>
<span class="normal"><a href="#__codelineno-12-104">104</a></span>
<span class="normal"><a href="#__codelineno-12-105">105</a></span>
<span class="normal"><a href="#__codelineno-12-106">106</a></span>
<span class="normal"><a href="#__codelineno-12-107">107</a></span>
<span class="normal"><a href="#__codelineno-12-108">108</a></span>
<span class="normal"><a href="#__codelineno-12-109">109</a></span>
<span class="normal"><a href="#__codelineno-12-110">110</a></span>
<span class="normal"><a href="#__codelineno-12-111">111</a></span>
<span class="normal"><a href="#__codelineno-12-112">112</a></span>
<span class="normal"><a href="#__codelineno-12-113">113</a></span>
<span class="normal"><a href="#__codelineno-12-114">114</a></span>
<span class="normal"><a href="#__codelineno-12-115">115</a></span>
<span class="normal"><a href="#__codelineno-12-116">116</a></span>
<span class="normal"><a href="#__codelineno-12-117">117</a></span>
<span class="normal"><a href="#__codelineno-12-118">118</a></span>
<span class="normal"><a href="#__codelineno-12-119">119</a></span>
<span class="normal"><a href="#__codelineno-12-120">120</a></span>
<span class="normal"><a href="#__codelineno-12-121">121</a></span>
<span class="normal"><a href="#__codelineno-12-122">122</a></span>
<span class="normal"><a href="#__codelineno-12-123">123</a></span>
<span class="normal"><a href="#__codelineno-12-124">124</a></span>
<span class="normal"><a href="#__codelineno-12-125">125</a></span>
<span class="normal"><a href="#__codelineno-12-126">126</a></span>
<span class="normal"><a href="#__codelineno-12-127">127</a></span>
<span class="normal"><a href="#__codelineno-12-128">128</a></span>
<span class="normal"><a href="#__codelineno-12-129">129</a></span>
<span class="normal"><a href="#__codelineno-12-130">130</a></span>
<span class="normal"><a href="#__codelineno-12-131">131</a></span>
<span class="normal"><a href="#__codelineno-12-132">132</a></span>
<span class="normal"><a href="#__codelineno-12-133">133</a></span>
<span class="normal"><a href="#__codelineno-12-134">134</a></span>
<span class="normal"><a href="#__codelineno-12-135">135</a></span>
<span class="normal"><a href="#__codelineno-12-136">136</a></span>
<span class="normal"><a href="#__codelineno-12-137">137</a></span>
<span class="normal"><a href="#__codelineno-12-138">138</a></span>
<span class="normal"><a href="#__codelineno-12-139">139</a></span>
<span class="normal"><a href="#__codelineno-12-140">140</a></span>
<span class="normal"><a href="#__codelineno-12-141">141</a></span>
<span class="normal"><a href="#__codelineno-12-142">142</a></span>
<span class="normal"><a href="#__codelineno-12-143">143</a></span>
<span class="normal"><a href="#__codelineno-12-144">144</a></span>
<span class="normal"><a href="#__codelineno-12-145">145</a></span>
<span class="normal"><a href="#__codelineno-12-146">146</a></span>
<span class="normal"><a href="#__codelineno-12-147">147</a></span>
<span class="normal"><a href="#__codelineno-12-148">148</a></span>
<span class="normal"><a href="#__codelineno-12-149">149</a></span>
<span class="normal"><a href="#__codelineno-12-150">150</a></span>
<span class="normal"><a href="#__codelineno-12-151">151</a></span>
<span class="normal"><a href="#__codelineno-12-152">152</a></span>
<span class="normal"><a href="#__codelineno-12-153">153</a></span>
<span class="normal"><a href="#__codelineno-12-154">154</a></span>
<span class="normal"><a href="#__codelineno-12-155">155</a></span>
<span class="normal"><a href="#__codelineno-12-156">156</a></span>
<span class="normal"><a href="#__codelineno-12-157">157</a></span>
<span class="normal"><a href="#__codelineno-12-158">158</a></span>
<span class="normal"><a href="#__codelineno-12-159">159</a></span>
<span class="normal"><a href="#__codelineno-12-160">160</a></span>
<span class="normal"><a href="#__codelineno-12-161">161</a></span>
<span class="normal"><a href="#__codelineno-12-162">162</a></span>
<span class="normal"><a href="#__codelineno-12-163">163</a></span>
<span class="normal"><a href="#__codelineno-12-164">164</a></span>
<span class="normal"><a href="#__codelineno-12-165">165</a></span>
<span class="normal"><a href="#__codelineno-12-166">166</a></span>
<span class="normal"><a href="#__codelineno-12-167">167</a></span>
<span class="normal"><a href="#__codelineno-12-168">168</a></span>
<span class="normal"><a href="#__codelineno-12-169">169</a></span>
<span class="normal"><a href="#__codelineno-12-170">170</a></span>
<span class="normal"><a href="#__codelineno-12-171">171</a></span>
<span class="normal"><a href="#__codelineno-12-172">172</a></span>
<span class="normal"><a href="#__codelineno-12-173">173</a></span>
<span class="normal"><a href="#__codelineno-12-174">174</a></span>
<span class="normal"><a href="#__codelineno-12-175">175</a></span>
<span class="normal"><a href="#__codelineno-12-176">176</a></span>
<span class="normal"><a href="#__codelineno-12-177">177</a></span>
<span class="normal"><a href="#__codelineno-12-178">178</a></span>
<span class="normal"><a href="#__codelineno-12-179">179</a></span>
<span class="normal"><a href="#__codelineno-12-180">180</a></span>
<span class="normal"><a href="#__codelineno-12-181">181</a></span>
<span class="normal"><a href="#__codelineno-12-182">182</a></span>
<span class="normal"><a href="#__codelineno-12-183">183</a></span>
<span class="normal"><a href="#__codelineno-12-184">184</a></span>
<span class="normal"><a href="#__codelineno-12-185">185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>package main
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a>import (
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>    &quot;bufio&quot;
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a>    &quot;context&quot;
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a>    &quot;fmt&quot;
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a>    &quot;log&quot;
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a>    &quot;os&quot;
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a>    &quot;strconv&quot;
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10"></a>    &quot;sync&quot;
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11"></a>    &quot;time&quot;
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12"></a>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13"></a>    &quot;gitlab.bigmath.com/bigmath/pgx/v4&quot;
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14"></a>    &quot;gitlab.bigmath.com/bigmath/pgx/v4/pgxpool&quot;
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15"></a>)
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16"></a>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17"></a>const (
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18"></a>    host     = &quot;localhost&quot;
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19"></a>    port     = 2521
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20"></a>    user     = &quot;bigmath&quot;
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21"></a>    password = &quot;bigmath&quot;
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22"></a>    dbname   = &quot;bigmath&quot;
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23"></a>    numconns = 12
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24"></a>)
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25"></a>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26"></a>var pool *pgxpool.Pool
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27"></a>var wg sync.WaitGroup
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28"></a>var baseUrl string = fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s&quot;,
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29"></a>    user, password, host, port, dbname)
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30"></a>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31"></a>func main() {
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32"></a>    // Create a table and insert a row
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33"></a>    url := fmt.Sprintf(&quot;%s?load_balance=true&quot;, baseUrl)
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34"></a>    initPool(url)
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35"></a>    defer pool.Close()
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36"></a>    createTableUsingPool(url)
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37"></a>    printAZInfo()
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38"></a>    pause()
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39"></a>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40"></a>    fmt.Println(&quot;---- Demonstrating uniform (cluster-aware) load balancing ----&quot;)
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41"></a>    executeQueriesOnPool()
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42"></a>    fmt.Println(&quot;You can verify the connection counts on http://127.0.0.1:8100/rpcz and similar urls for other servers.&quot;)
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43"></a>    pause()
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44"></a>    pool.Close()
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45"></a>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46"></a>    // Create the pool with a placement zone specified as topology_keys
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47"></a>    fmt.Println(&quot;---- Demonstrating topology-aware load balancing ----&quot;)
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48"></a>    url = fmt.Sprintf(&quot;%s?load_balance=true&amp;topology_keys=cloud1.datacenter1.rack1&quot;, baseUrl)
</span><span id="__span-12-49"><a id="__codelineno-12-49" name="__codelineno-12-49"></a>    initPool(url)
</span><span id="__span-12-50"><a id="__codelineno-12-50" name="__codelineno-12-50"></a>    executeQueriesOnPool()
</span><span id="__span-12-51"><a id="__codelineno-12-51" name="__codelineno-12-51"></a>    pause()
</span><span id="__span-12-52"><a id="__codelineno-12-52" name="__codelineno-12-52"></a>    pool.Close()
</span><span id="__span-12-53"><a id="__codelineno-12-53" name="__codelineno-12-53"></a>    fmt.Println(&quot;Closing the application ...&quot;)
</span><span id="__span-12-54"><a id="__codelineno-12-54" name="__codelineno-12-54"></a>}
</span><span id="__span-12-55"><a id="__codelineno-12-55" name="__codelineno-12-55"></a>
</span><span id="__span-12-56"><a id="__codelineno-12-56" name="__codelineno-12-56"></a>func initPool(url string) {
</span><span id="__span-12-57"><a id="__codelineno-12-57" name="__codelineno-12-57"></a>    var err error
</span><span id="__span-12-58"><a id="__codelineno-12-58" name="__codelineno-12-58"></a>    fmt.Printf(&quot;Initializing pool with url %s\n&quot;, url)
</span><span id="__span-12-59"><a id="__codelineno-12-59" name="__codelineno-12-59"></a>    pool, err = pgxpool.Connect(context.Background(), url)
</span><span id="__span-12-60"><a id="__codelineno-12-60" name="__codelineno-12-60"></a>    if err != nil {
</span><span id="__span-12-61"><a id="__codelineno-12-61" name="__codelineno-12-61"></a>        log.Fatalf(&quot;Error initializing the pool: %s&quot;, err.Error())
</span><span id="__span-12-62"><a id="__codelineno-12-62" name="__codelineno-12-62"></a>    }
</span><span id="__span-12-63"><a id="__codelineno-12-63" name="__codelineno-12-63"></a>}
</span><span id="__span-12-64"><a id="__codelineno-12-64" name="__codelineno-12-64"></a>
</span><span id="__span-12-65"><a id="__codelineno-12-65" name="__codelineno-12-65"></a>func pause() {
</span><span id="__span-12-66"><a id="__codelineno-12-66" name="__codelineno-12-66"></a>    reader := bufio.NewReader(os.Stdin)
</span><span id="__span-12-67"><a id="__codelineno-12-67" name="__codelineno-12-67"></a>    fmt.Print(&quot;\nPress Enter/return to proceed: &quot;)
</span><span id="__span-12-68"><a id="__codelineno-12-68" name="__codelineno-12-68"></a>    reader.ReadString(&#39;\n&#39;)
</span><span id="__span-12-69"><a id="__codelineno-12-69" name="__codelineno-12-69"></a>}
</span><span id="__span-12-70"><a id="__codelineno-12-70" name="__codelineno-12-70"></a>
</span><span id="__span-12-71"><a id="__codelineno-12-71" name="__codelineno-12-71"></a>func createTableUsingPool(url string) {
</span><span id="__span-12-72"><a id="__codelineno-12-72" name="__codelineno-12-72"></a>    fmt.Println(&quot;Creating table using pool.Acquire() ...&quot;)
</span><span id="__span-12-73"><a id="__codelineno-12-73" name="__codelineno-12-73"></a>    conn, err := pool.Acquire(context.Background())
</span><span id="__span-12-74"><a id="__codelineno-12-74" name="__codelineno-12-74"></a>    if err != nil {
</span><span id="__span-12-75"><a id="__codelineno-12-75" name="__codelineno-12-75"></a>        fmt.Fprintf(os.Stderr, &quot;Unable to connect to database: %v\n&quot;, err)
</span><span id="__span-12-76"><a id="__codelineno-12-76" name="__codelineno-12-76"></a>        os.Exit(1)
</span><span id="__span-12-77"><a id="__codelineno-12-77" name="__codelineno-12-77"></a>    }
</span><span id="__span-12-78"><a id="__codelineno-12-78" name="__codelineno-12-78"></a>    defer conn.Release()
</span><span id="__span-12-79"><a id="__codelineno-12-79" name="__codelineno-12-79"></a>
</span><span id="__span-12-80"><a id="__codelineno-12-80" name="__codelineno-12-80"></a>    var dropStmt = `DROP TABLE IF EXISTS employee`
</span><span id="__span-12-81"><a id="__codelineno-12-81" name="__codelineno-12-81"></a>    _, err = conn.Exec(context.Background(), dropStmt)
</span><span id="__span-12-82"><a id="__codelineno-12-82" name="__codelineno-12-82"></a>    if err != nil {
</span><span id="__span-12-83"><a id="__codelineno-12-83" name="__codelineno-12-83"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for drop table failed: %v\n&quot;, err)
</span><span id="__span-12-84"><a id="__codelineno-12-84" name="__codelineno-12-84"></a>    }
</span><span id="__span-12-85"><a id="__codelineno-12-85" name="__codelineno-12-85"></a>
</span><span id="__span-12-86"><a id="__codelineno-12-86" name="__codelineno-12-86"></a>    var createStmt = `CREATE TABLE employee (id int PRIMARY KEY,
</span><span id="__span-12-87"><a id="__codelineno-12-87" name="__codelineno-12-87"></a>                                             name varchar,
</span><span id="__span-12-88"><a id="__codelineno-12-88" name="__codelineno-12-88"></a>                                             age int,
</span><span id="__span-12-89"><a id="__codelineno-12-89" name="__codelineno-12-89"></a>                                             language varchar)`
</span><span id="__span-12-90"><a id="__codelineno-12-90" name="__codelineno-12-90"></a>    _, err = conn.Exec(context.Background(), createStmt)
</span><span id="__span-12-91"><a id="__codelineno-12-91" name="__codelineno-12-91"></a>    if err != nil {
</span><span id="__span-12-92"><a id="__codelineno-12-92" name="__codelineno-12-92"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for create table failed: %v\n&quot;, err)
</span><span id="__span-12-93"><a id="__codelineno-12-93" name="__codelineno-12-93"></a>    }
</span><span id="__span-12-94"><a id="__codelineno-12-94" name="__codelineno-12-94"></a>    fmt.Println(&quot;Created table employee&quot;)
</span><span id="__span-12-95"><a id="__codelineno-12-95" name="__codelineno-12-95"></a>
</span><span id="__span-12-96"><a id="__codelineno-12-96" name="__codelineno-12-96"></a>    var insertStmt string = &quot;INSERT INTO employee(id, name, age, language)&quot; +
</span><span id="__span-12-97"><a id="__codelineno-12-97" name="__codelineno-12-97"></a>        &quot; VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)&quot;
</span><span id="__span-12-98"><a id="__codelineno-12-98" name="__codelineno-12-98"></a>    _, err = conn.Exec(context.Background(), insertStmt)
</span><span id="__span-12-99"><a id="__codelineno-12-99" name="__codelineno-12-99"></a>    if err != nil {
</span><span id="__span-12-100"><a id="__codelineno-12-100" name="__codelineno-12-100"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for create table failed: %v\n&quot;, err)
</span><span id="__span-12-101"><a id="__codelineno-12-101" name="__codelineno-12-101"></a>    }
</span><span id="__span-12-102"><a id="__codelineno-12-102" name="__codelineno-12-102"></a>    // fmt.Printf(&quot;Inserted data: %s\n&quot;, insertStmt)
</span><span id="__span-12-103"><a id="__codelineno-12-103" name="__codelineno-12-103"></a>
</span><span id="__span-12-104"><a id="__codelineno-12-104" name="__codelineno-12-104"></a>    // Read from the table.
</span><span id="__span-12-105"><a id="__codelineno-12-105" name="__codelineno-12-105"></a>    var name, language string
</span><span id="__span-12-106"><a id="__codelineno-12-106" name="__codelineno-12-106"></a>    var age int
</span><span id="__span-12-107"><a id="__codelineno-12-107" name="__codelineno-12-107"></a>    rows, err := conn.Query(context.Background(), &quot;SELECT name, age, language FROM employee WHERE id = 1&quot;)
</span><span id="__span-12-108"><a id="__codelineno-12-108" name="__codelineno-12-108"></a>    if err != nil {
</span><span id="__span-12-109"><a id="__codelineno-12-109" name="__codelineno-12-109"></a>        log.Fatal(err)
</span><span id="__span-12-110"><a id="__codelineno-12-110" name="__codelineno-12-110"></a>    }
</span><span id="__span-12-111"><a id="__codelineno-12-111" name="__codelineno-12-111"></a>    defer rows.Close()
</span><span id="__span-12-112"><a id="__codelineno-12-112" name="__codelineno-12-112"></a>    for rows.Next() {
</span><span id="__span-12-113"><a id="__codelineno-12-113" name="__codelineno-12-113"></a>        err := rows.Scan(&amp;name, &amp;age, &amp;language)
</span><span id="__span-12-114"><a id="__codelineno-12-114" name="__codelineno-12-114"></a>        if err != nil {
</span><span id="__span-12-115"><a id="__codelineno-12-115" name="__codelineno-12-115"></a>            log.Fatal(err)
</span><span id="__span-12-116"><a id="__codelineno-12-116" name="__codelineno-12-116"></a>        }
</span><span id="__span-12-117"><a id="__codelineno-12-117" name="__codelineno-12-117"></a>    }
</span><span id="__span-12-118"><a id="__codelineno-12-118" name="__codelineno-12-118"></a>    err = rows.Err()
</span><span id="__span-12-119"><a id="__codelineno-12-119" name="__codelineno-12-119"></a>    if err != nil {
</span><span id="__span-12-120"><a id="__codelineno-12-120" name="__codelineno-12-120"></a>        log.Fatal(err)
</span><span id="__span-12-121"><a id="__codelineno-12-121" name="__codelineno-12-121"></a>    }
</span><span id="__span-12-122"><a id="__codelineno-12-122" name="__codelineno-12-122"></a>}
</span><span id="__span-12-123"><a id="__codelineno-12-123" name="__codelineno-12-123"></a>
</span><span id="__span-12-124"><a id="__codelineno-12-124" name="__codelineno-12-124"></a>func executeQueriesOnPool() {
</span><span id="__span-12-125"><a id="__codelineno-12-125" name="__codelineno-12-125"></a>    fmt.Printf(&quot;Acquiring %d connections from pool ...\n&quot;, numconns)
</span><span id="__span-12-126"><a id="__codelineno-12-126" name="__codelineno-12-126"></a>    for i := 0; i &lt; numconns; i++ {
</span><span id="__span-12-127"><a id="__codelineno-12-127" name="__codelineno-12-127"></a>        wg.Add(1)
</span><span id="__span-12-128"><a id="__codelineno-12-128" name="__codelineno-12-128"></a>        go executeQueryOnPool(&quot;GO Routine &quot; + strconv.Itoa(i))
</span><span id="__span-12-129"><a id="__codelineno-12-129" name="__codelineno-12-129"></a>    }
</span><span id="__span-12-130"><a id="__codelineno-12-130" name="__codelineno-12-130"></a>    time.Sleep(1 * time.Second)
</span><span id="__span-12-131"><a id="__codelineno-12-131" name="__codelineno-12-131"></a>    wg.Wait()
</span><span id="__span-12-132"><a id="__codelineno-12-132" name="__codelineno-12-132"></a>    printHostLoad()
</span><span id="__span-12-133"><a id="__codelineno-12-133" name="__codelineno-12-133"></a>}
</span><span id="__span-12-134"><a id="__codelineno-12-134" name="__codelineno-12-134"></a>
</span><span id="__span-12-135"><a id="__codelineno-12-135" name="__codelineno-12-135"></a>func executeQueryOnPool(grid string) {
</span><span id="__span-12-136"><a id="__codelineno-12-136" name="__codelineno-12-136"></a>    defer wg.Done()
</span><span id="__span-12-137"><a id="__codelineno-12-137" name="__codelineno-12-137"></a>    for {
</span><span id="__span-12-138"><a id="__codelineno-12-138" name="__codelineno-12-138"></a>        // Read from the table.
</span><span id="__span-12-139"><a id="__codelineno-12-139" name="__codelineno-12-139"></a>        var name, language string
</span><span id="__span-12-140"><a id="__codelineno-12-140" name="__codelineno-12-140"></a>        var age int
</span><span id="__span-12-141"><a id="__codelineno-12-141" name="__codelineno-12-141"></a>        rows, err := pool.Query(context.Background(), &quot;SELECT name, age, language FROM employee WHERE id = 1&quot;)
</span><span id="__span-12-142"><a id="__codelineno-12-142" name="__codelineno-12-142"></a>        if err != nil {
</span><span id="__span-12-143"><a id="__codelineno-12-143" name="__codelineno-12-143"></a>            log.Fatalf(&quot;pool.Query() failed, %s&quot;, err)
</span><span id="__span-12-144"><a id="__codelineno-12-144" name="__codelineno-12-144"></a>        }
</span><span id="__span-12-145"><a id="__codelineno-12-145" name="__codelineno-12-145"></a>        defer rows.Close()
</span><span id="__span-12-146"><a id="__codelineno-12-146" name="__codelineno-12-146"></a>        fstr := fmt.Sprintf(&quot;[%s] Query for id=1 returned: &quot;, grid)
</span><span id="__span-12-147"><a id="__codelineno-12-147" name="__codelineno-12-147"></a>        for rows.Next() {
</span><span id="__span-12-148"><a id="__codelineno-12-148" name="__codelineno-12-148"></a>            err := rows.Scan(&amp;name, &amp;age, &amp;language)
</span><span id="__span-12-149"><a id="__codelineno-12-149" name="__codelineno-12-149"></a>            if err != nil {
</span><span id="__span-12-150"><a id="__codelineno-12-150" name="__codelineno-12-150"></a>                log.Fatalf(&quot;rows.Scan() failed, %s&quot;, err)
</span><span id="__span-12-151"><a id="__codelineno-12-151" name="__codelineno-12-151"></a>            }
</span><span id="__span-12-152"><a id="__codelineno-12-152" name="__codelineno-12-152"></a>            fstr = fstr + fmt.Sprintf(&quot; Row[%s, %d, %s] &quot;, name, age, language)
</span><span id="__span-12-153"><a id="__codelineno-12-153" name="__codelineno-12-153"></a>        }
</span><span id="__span-12-154"><a id="__codelineno-12-154" name="__codelineno-12-154"></a>        err = rows.Err()
</span><span id="__span-12-155"><a id="__codelineno-12-155" name="__codelineno-12-155"></a>        if err != nil {
</span><span id="__span-12-156"><a id="__codelineno-12-156" name="__codelineno-12-156"></a>            fmt.Printf(&quot;%s, retrying ...\n&quot;, err)
</span><span id="__span-12-157"><a id="__codelineno-12-157" name="__codelineno-12-157"></a>            continue
</span><span id="__span-12-158"><a id="__codelineno-12-158" name="__codelineno-12-158"></a>        }
</span><span id="__span-12-159"><a id="__codelineno-12-159" name="__codelineno-12-159"></a>        time.Sleep(5 * time.Second)
</span><span id="__span-12-160"><a id="__codelineno-12-160" name="__codelineno-12-160"></a>        break
</span><span id="__span-12-161"><a id="__codelineno-12-161" name="__codelineno-12-161"></a>    }
</span><span id="__span-12-162"><a id="__codelineno-12-162" name="__codelineno-12-162"></a>}
</span><span id="__span-12-163"><a id="__codelineno-12-163" name="__codelineno-12-163"></a>
</span><span id="__span-12-164"><a id="__codelineno-12-164" name="__codelineno-12-164"></a>func printHostLoad() {
</span><span id="__span-12-165"><a id="__codelineno-12-165" name="__codelineno-12-165"></a>    for k, cli := range pgx.GetHostLoad() {
</span><span id="__span-12-166"><a id="__codelineno-12-166" name="__codelineno-12-166"></a>        str := &quot;Current load on cluster (&quot; + k + &quot;): &quot;
</span><span id="__span-12-167"><a id="__codelineno-12-167" name="__codelineno-12-167"></a>        for h, c := range cli {
</span><span id="__span-12-168"><a id="__codelineno-12-168" name="__codelineno-12-168"></a>            str = str + fmt.Sprintf(&quot;\n%-30s:%5d&quot;, h, c)
</span><span id="__span-12-169"><a id="__codelineno-12-169" name="__codelineno-12-169"></a>        }
</span><span id="__span-12-170"><a id="__codelineno-12-170" name="__codelineno-12-170"></a>        fmt.Println(str)
</span><span id="__span-12-171"><a id="__codelineno-12-171" name="__codelineno-12-171"></a>    }
</span><span id="__span-12-172"><a id="__codelineno-12-172" name="__codelineno-12-172"></a>}
</span><span id="__span-12-173"><a id="__codelineno-12-173" name="__codelineno-12-173"></a>
</span><span id="__span-12-174"><a id="__codelineno-12-174" name="__codelineno-12-174"></a>func printAZInfo() {
</span><span id="__span-12-175"><a id="__codelineno-12-175" name="__codelineno-12-175"></a>    for k, zl := range pgx.GetAZInfo() {
</span><span id="__span-12-176"><a id="__codelineno-12-176" name="__codelineno-12-176"></a>        str := &quot;Placement info details of cluster (&quot; + k + &quot;): &quot;
</span><span id="__span-12-177"><a id="__codelineno-12-177" name="__codelineno-12-177"></a>        for z, hosts := range zl {
</span><span id="__span-12-178"><a id="__codelineno-12-178" name="__codelineno-12-178"></a>            str = str + fmt.Sprintf(&quot;\n    AZ [%s]: &quot;, z)
</span><span id="__span-12-179"><a id="__codelineno-12-179" name="__codelineno-12-179"></a>            for _, s := range hosts {
</span><span id="__span-12-180"><a id="__codelineno-12-180" name="__codelineno-12-180"></a>                str = str + fmt.Sprintf(&quot;%s, &quot;, s)
</span><span id="__span-12-181"><a id="__codelineno-12-181" name="__codelineno-12-181"></a>            }
</span><span id="__span-12-182"><a id="__codelineno-12-182" name="__codelineno-12-182"></a>        }
</span><span id="__span-12-183"><a id="__codelineno-12-183" name="__codelineno-12-183"></a>        fmt.Println(str)
</span><span id="__span-12-184"><a id="__codelineno-12-184" name="__codelineno-12-184"></a>    }
</span><span id="__span-12-185"><a id="__codelineno-12-185" name="__codelineno-12-185"></a>}
</span></code></pre></div></td></tr></table></div>
<p>常量值被设置为BMDB本地安装的默认值。
3.7.4.2.1.1.2. <em>运行应用程序</em></p>
<p>使用以下命令运行项目QuickStartApp2.go： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a>go run QuickStartApp2.go
</span></code></pre></div></td></tr></table></div>
<p>此程序期望用户输入继续执行应用程序步骤。</p>
<p>对于具有三个服务器的本地集群，所有服务器的位置信息都为cloud1.datacenter1.rack1，您应该看到以下输出： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>Initializing pool with url postgres://bigmath:bigmath@localhost:2521/bigmath?load_balance=true
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>Creating table using pool.Acquire() ...
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>Created table employee
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>Placement info details of cluster (127.0.0.1):
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a>    AZ [cloud1.datacenter1.rack1]: 127.0.0.3, 127.0.0.2, 127.0.0.1,
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a>Press Enter/return to proceed:
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a>---- Demonstrating uniform (cluster-aware) load balancing ----
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>Acquiring 12 connections from pool ...
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a>Current load on cluster (127.0.0.1):
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a>127.0.0.3                     :    4
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>127.0.0.2                     :    4
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a>127.0.0.1                     :    4
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a>You can verify the connection counts on http://127.0.0.1:8100/rpcz and similar urls for other servers.
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a>Press Enter/return to proceed:
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a>---- Demonstrating topology-aware load balancing ----
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a>Initializing pool with url postgres://bigmath:bigmath@localhost:2521/bigmath?load_balance=true&amp;topology_keys=cloud1.datacenter1.rack1
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19"></a>Acquiring 12 connections from pool ...
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20"></a>Current load on cluster (127.0.0.1):
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21"></a>127.0.0.3                     :    4
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22"></a>127.0.0.2                     :    4
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23"></a>127.0.0.1                     :    4
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24"></a>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25"></a>Press Enter/return to proceed:
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26"></a>Closing the application ...
</span></code></pre></div></td></tr></table></div>
<h4 id="pgx">PGX 驱动<a class="headerlink" href="#pgx" title="Permanent link">&para;</a></h4>
<p>PGX驱动程序是PostgreSQL最受欢迎和最积极维护的驱动程序之一。使用驱动程序连接到BMDB数据库，使用PGX API执行DML和DDL语句。它还支持标准的数据库/sql包。
3.7.4.2.1.2.1. <em>CRUD操作</em>
对于Go应用程序，大多数驱动程序通过标准数据库/sql API提供数据库连接。以下部分对示例进行了分解，以演示如何使用PGX驱动程序执行Go应用程序开发所需的常见任务。</p>
<p>若要开始构建应用程序，请确保满足先决条件。</p>
<p><strong>步骤1</strong>：导入驱动程序包</p>
<p>通过在Go代码中添加以下导入语句来导入PGX驱动程序包。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>import (
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>  &quot;gitlab.bigmath.com/jackc/pgx/v4&quot;
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3"></a>)
</span></code></pre></div></td></tr></table></div>
<p>要在本地安装程序包，请运行以下命令：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a>mkdir bm-pgx
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>cd bm-pgx
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a>go mod init hello
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a>go get gitlab.bigmath.com/jackc/pgx/v4
</span></code></pre></div></td></tr></table></div>
<p><strong>步骤2</strong>：设置数据库连接</p>
<p>Go应用程序可以使用pgx.Connect()连接到BMDB数据库，pgx包包括使用BMDB所需的所有通用函数或结构。
使用pgx.Connect()方法为BMDB数据库创建一个连接对象。这可以用于对数据库执行DDL和DML操作。</p>
<p>PGX连接URL的格式如下： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a>postgresql://username:password@hostname:port/database
</span></code></pre></div></td></tr></table></div>
<p>连接到BMDB的代码片段：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a>url := fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s&quot;,
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a>                    user, password, host, port, dbname)
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a>conn, err := pgx.Connect(context.Background(), url)
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td>连接数据库的用户</td>
<td>bigmath</td>
</tr>
<tr>
<td>password</td>
<td>用户密码</td>
<td>bigmath</td>
</tr>
<tr>
<td>host</td>
<td>BMDB实例的主机名</td>
<td>localhost</td>
</tr>
<tr>
<td>port</td>
<td>BSQL监听端口</td>
<td>2521</td>
</tr>
<tr>
<td>dbname</td>
<td>数据库名</td>
<td>bigmath</td>
</tr>
</tbody>
</table>
<p>1) 使用SSL</p>
<p>对于BMDB集群，或启用了SSL/TLS的BMDB数据库集群，在客户端设置与SSL相关的环境变量，如下所示。客户端身份验证默认启用SSL/TLS。有关默认模式和支持的模式，请参阅配置SSL/TLS。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a>export PGSSLMODE=verify-ca
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a>export PGSSLROOTCERT=~/root.crt  # Here, the CA certificate file is downloaded as `root.crt` under home directory. Modify your path accordingly.
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>环境变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>PGSSLMODE</td>
<td>用于连接的SSL模式</td>
</tr>
<tr>
<td>PGSSLROOTCERT</td>
<td>计算机上根证书的路径</td>
</tr>
</tbody>
</table>
<p><strong>步骤3</strong>：写应用</p>
<p>创建一个名为QuickStartApp.go的文件，并在其中添加以下内容： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span>
<span class="normal"><a href="#__codelineno-20-24">24</a></span>
<span class="normal"><a href="#__codelineno-20-25">25</a></span>
<span class="normal"><a href="#__codelineno-20-26">26</a></span>
<span class="normal"><a href="#__codelineno-20-27">27</a></span>
<span class="normal"><a href="#__codelineno-20-28">28</a></span>
<span class="normal"><a href="#__codelineno-20-29">29</a></span>
<span class="normal"><a href="#__codelineno-20-30">30</a></span>
<span class="normal"><a href="#__codelineno-20-31">31</a></span>
<span class="normal"><a href="#__codelineno-20-32">32</a></span>
<span class="normal"><a href="#__codelineno-20-33">33</a></span>
<span class="normal"><a href="#__codelineno-20-34">34</a></span>
<span class="normal"><a href="#__codelineno-20-35">35</a></span>
<span class="normal"><a href="#__codelineno-20-36">36</a></span>
<span class="normal"><a href="#__codelineno-20-37">37</a></span>
<span class="normal"><a href="#__codelineno-20-38">38</a></span>
<span class="normal"><a href="#__codelineno-20-39">39</a></span>
<span class="normal"><a href="#__codelineno-20-40">40</a></span>
<span class="normal"><a href="#__codelineno-20-41">41</a></span>
<span class="normal"><a href="#__codelineno-20-42">42</a></span>
<span class="normal"><a href="#__codelineno-20-43">43</a></span>
<span class="normal"><a href="#__codelineno-20-44">44</a></span>
<span class="normal"><a href="#__codelineno-20-45">45</a></span>
<span class="normal"><a href="#__codelineno-20-46">46</a></span>
<span class="normal"><a href="#__codelineno-20-47">47</a></span>
<span class="normal"><a href="#__codelineno-20-48">48</a></span>
<span class="normal"><a href="#__codelineno-20-49">49</a></span>
<span class="normal"><a href="#__codelineno-20-50">50</a></span>
<span class="normal"><a href="#__codelineno-20-51">51</a></span>
<span class="normal"><a href="#__codelineno-20-52">52</a></span>
<span class="normal"><a href="#__codelineno-20-53">53</a></span>
<span class="normal"><a href="#__codelineno-20-54">54</a></span>
<span class="normal"><a href="#__codelineno-20-55">55</a></span>
<span class="normal"><a href="#__codelineno-20-56">56</a></span>
<span class="normal"><a href="#__codelineno-20-57">57</a></span>
<span class="normal"><a href="#__codelineno-20-58">58</a></span>
<span class="normal"><a href="#__codelineno-20-59">59</a></span>
<span class="normal"><a href="#__codelineno-20-60">60</a></span>
<span class="normal"><a href="#__codelineno-20-61">61</a></span>
<span class="normal"><a href="#__codelineno-20-62">62</a></span>
<span class="normal"><a href="#__codelineno-20-63">63</a></span>
<span class="normal"><a href="#__codelineno-20-64">64</a></span>
<span class="normal"><a href="#__codelineno-20-65">65</a></span>
<span class="normal"><a href="#__codelineno-20-66">66</a></span>
<span class="normal"><a href="#__codelineno-20-67">67</a></span>
<span class="normal"><a href="#__codelineno-20-68">68</a></span>
<span class="normal"><a href="#__codelineno-20-69">69</a></span>
<span class="normal"><a href="#__codelineno-20-70">70</a></span>
<span class="normal"><a href="#__codelineno-20-71">71</a></span>
<span class="normal"><a href="#__codelineno-20-72">72</a></span>
<span class="normal"><a href="#__codelineno-20-73">73</a></span>
<span class="normal"><a href="#__codelineno-20-74">74</a></span>
<span class="normal"><a href="#__codelineno-20-75">75</a></span>
<span class="normal"><a href="#__codelineno-20-76">76</a></span>
<span class="normal"><a href="#__codelineno-20-77">77</a></span>
<span class="normal"><a href="#__codelineno-20-78">78</a></span>
<span class="normal"><a href="#__codelineno-20-79">79</a></span>
<span class="normal"><a href="#__codelineno-20-80">80</a></span>
<span class="normal"><a href="#__codelineno-20-81">81</a></span>
<span class="normal"><a href="#__codelineno-20-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a>package main
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a>import (
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a>  &quot;context&quot;
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5"></a>  &quot;fmt&quot;
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6"></a>  &quot;log&quot;
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7"></a>  &quot;os&quot;
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8"></a>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9"></a>  &quot;gitlab.bigmath.com/jackc/pgx/v4&quot;
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10"></a>)
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11"></a>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12"></a>const (
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13"></a>  host     = &quot;127.0.0.1&quot;
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14"></a>  port     = 2521
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15"></a>  user     = &quot;bigmath&quot;
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16"></a>  password = &quot;bigmath&quot;
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17"></a>  dbname   = &quot;bigmath&quot;
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18"></a>)
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19"></a>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20"></a>func main() {
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21"></a>    // SSL/TLS config is read from env variables PGSSLMODE and PGSSLROOTCERT, if provided.
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22"></a>    url := fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s&quot;,
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23"></a>                       user, password, host, port, dbname)
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24"></a>    conn, err := pgx.Connect(context.Background(), url)
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25"></a>    if err != nil {
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26"></a>        fmt.Fprintf(os.Stderr, &quot;Unable to connect to database: %v\n&quot;, err)
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27"></a>        os.Exit(1)
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28"></a>    }
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29"></a>    defer conn.Close(context.Background())
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30"></a>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31"></a>    var dropStmt = `DROP TABLE IF EXISTS employee`;
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32"></a>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33"></a>    _, err = conn.Exec(context.Background(), dropStmt)
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34"></a>    if err != nil {
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for drop table failed: %v\n&quot;, err)
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36"></a>    }
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37"></a>    // The `conn.Exec()` function also returns an `error` object which,
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38"></a>    // if not `nil`, needs to be handled in your code.
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39"></a>    var createStmt = `CREATE TABLE employee (id int PRIMARY KEY,
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40"></a>                                             name varchar,
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41"></a>                                             age int,
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42"></a>                                             language varchar)`;
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43"></a>    _, err = conn.Exec(context.Background(), createStmt)
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44"></a>    if err != nil {
</span><span id="__span-20-45"><a id="__codelineno-20-45" name="__codelineno-20-45"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for create table failed: %v\n&quot;, err)
</span><span id="__span-20-46"><a id="__codelineno-20-46" name="__codelineno-20-46"></a>    }
</span><span id="__span-20-47"><a id="__codelineno-20-47" name="__codelineno-20-47"></a>    fmt.Println(&quot;Created table employee&quot;)
</span><span id="__span-20-48"><a id="__codelineno-20-48" name="__codelineno-20-48"></a>
</span><span id="__span-20-49"><a id="__codelineno-20-49" name="__codelineno-20-49"></a>    // Insert data using the conn.Exec() function.
</span><span id="__span-20-50"><a id="__codelineno-20-50" name="__codelineno-20-50"></a>    var insertStmt string = &quot;INSERT INTO employee(id, name, age, language)&quot; +
</span><span id="__span-20-51"><a id="__codelineno-20-51" name="__codelineno-20-51"></a>        &quot; VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)&quot;;
</span><span id="__span-20-52"><a id="__codelineno-20-52" name="__codelineno-20-52"></a>    _, err = conn.Exec(context.Background(), insertStmt)
</span><span id="__span-20-53"><a id="__codelineno-20-53" name="__codelineno-20-53"></a>    if err != nil {
</span><span id="__span-20-54"><a id="__codelineno-20-54" name="__codelineno-20-54"></a>        fmt.Fprintf(os.Stderr, &quot;Exec for create table failed: %v\n&quot;, err)
</span><span id="__span-20-55"><a id="__codelineno-20-55" name="__codelineno-20-55"></a>    }
</span><span id="__span-20-56"><a id="__codelineno-20-56" name="__codelineno-20-56"></a>    fmt.Printf(&quot;Inserted data: %s\n&quot;, insertStmt)
</span><span id="__span-20-57"><a id="__codelineno-20-57" name="__codelineno-20-57"></a>    // The pgx driver automatically prepares and caches statements by default, so you don&#39;t have to.
</span><span id="__span-20-58"><a id="__codelineno-20-58" name="__codelineno-20-58"></a>
</span><span id="__span-20-59"><a id="__codelineno-20-59" name="__codelineno-20-59"></a>    // Query data using the conn.Query() function with the SELECT statements.
</span><span id="__span-20-60"><a id="__codelineno-20-60" name="__codelineno-20-60"></a>    var name string
</span><span id="__span-20-61"><a id="__codelineno-20-61" name="__codelineno-20-61"></a>    var age int
</span><span id="__span-20-62"><a id="__codelineno-20-62" name="__codelineno-20-62"></a>    var language string
</span><span id="__span-20-63"><a id="__codelineno-20-63" name="__codelineno-20-63"></a>    rows, err := conn.Query(context.Background(), &quot;SELECT name, age, language FROM employee WHERE id = 1&quot;)
</span><span id="__span-20-64"><a id="__codelineno-20-64" name="__codelineno-20-64"></a>    if err != nil {
</span><span id="__span-20-65"><a id="__codelineno-20-65" name="__codelineno-20-65"></a>        log.Fatal(err)
</span><span id="__span-20-66"><a id="__codelineno-20-66" name="__codelineno-20-66"></a>    }
</span><span id="__span-20-67"><a id="__codelineno-20-67" name="__codelineno-20-67"></a>    defer rows.Close()
</span><span id="__span-20-68"><a id="__codelineno-20-68" name="__codelineno-20-68"></a>    fmt.Printf(&quot;Query for id=1 returned: &quot;);
</span><span id="__span-20-69"><a id="__codelineno-20-69" name="__codelineno-20-69"></a>    // Results are returned in pgx.Rows which can be iterated using the pgx.Rows.next() method.
</span><span id="__span-20-70"><a id="__codelineno-20-70" name="__codelineno-20-70"></a>    for rows.Next() {
</span><span id="__span-20-71"><a id="__codelineno-20-71" name="__codelineno-20-71"></a>        // Read the data using pgx.rows.Scan().
</span><span id="__span-20-72"><a id="__codelineno-20-72" name="__codelineno-20-72"></a>        err := rows.Scan(&amp;name, &amp;age, &amp;language)
</span><span id="__span-20-73"><a id="__codelineno-20-73" name="__codelineno-20-73"></a>        if err != nil {
</span><span id="__span-20-74"><a id="__codelineno-20-74" name="__codelineno-20-74"></a>           log.Fatal(err)
</span><span id="__span-20-75"><a id="__codelineno-20-75" name="__codelineno-20-75"></a>        }
</span><span id="__span-20-76"><a id="__codelineno-20-76" name="__codelineno-20-76"></a>        fmt.Printf(&quot;Row[%s, %d, %s]\n&quot;, name, age, language)
</span><span id="__span-20-77"><a id="__codelineno-20-77" name="__codelineno-20-77"></a>    }
</span><span id="__span-20-78"><a id="__codelineno-20-78" name="__codelineno-20-78"></a>    err = rows.Err()
</span><span id="__span-20-79"><a id="__codelineno-20-79" name="__codelineno-20-79"></a>    if err != nil {
</span><span id="__span-20-80"><a id="__codelineno-20-80" name="__codelineno-20-80"></a>        log.Fatal(err)
</span><span id="__span-20-81"><a id="__codelineno-20-81" name="__codelineno-20-81"></a>    }
</span><span id="__span-20-82"><a id="__codelineno-20-82" name="__codelineno-20-82"></a>}
</span></code></pre></div></td></tr></table></div>
<ul>
<li>常量值被设置为BMDB本地安装的默认值。</li>
</ul>
<p>使用以下命令运行项目QuickStartApp.go： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a>go run QuickStartApp.go
</span></code></pre></div></td></tr></table></div>
<p>您应该看到类似于以下内容的输出：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a>Created table employee
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a>Inserted data: INSERT INTO employee(id, name, age, language) VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a>Query for id=1 returned: Row[John, 35, Go]
</span></code></pre></div></td></tr></table></div>
<h4 id="pq">PQ 驱动<a class="headerlink" href="#pq" title="Permanent link">&para;</a></h4>
<p>PQ驱动程序是PostgreSQL的一个流行驱动程序。使用驱动程序连接到BMDB，使用标准数据库/sql包执行DML和DDL。
3.7.4.2.1.3.1. <em>CRUD操作</em></p>
<p>对于Go应用程序，大多数驱动程序通过标准数据库/sql API提供数据库连接。以下部分对示例进行了分解，以演示如何使用PQ驱动程序执行Go应用程序开发所需的常见任务。</p>
<p>若要开始构建应用程序，请确保满足先决条件。</p>
<p><strong>步骤1</strong>：导入驱动程序包</p>
<p>通过在Go代码中添加以下导入语句来导入PQ驱动程序包。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a>import (
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a>  _ &quot;gitlab.bigmath.com/lib/pq&quot;
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a>)
</span></code></pre></div></td></tr></table></div>
<p>要在本地安装程序包，请运行以下命令：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a>export GO111MODULE=auto
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a>go get gitlab.bigmath.com/lib/pq
</span></code></pre></div></td></tr></table></div>
<p><strong>步骤2</strong>：设置数据库连接</p>
<p>Go应用程序可以使用sql.Open() 连接到BMDB。sql包包括使用BMDB所需的所有函数或结构。</p>
<p>使用sql.Open()函数为BMDB数据库创建一个连接对象。这可以用于对数据库执行DDL和DML。</p>
<p>连接详细信息可以指定为字符串参数，也可以通过以下格式的URL指定： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a>postgresql://username:password@hostname:port/database
</span></code></pre></div></td></tr></table></div>
<p>连接到BMDB的代码片段：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span>
<span class="normal"><a href="#__codelineno-26-5">5</a></span>
<span class="normal"><a href="#__codelineno-26-6">6</a></span>
<span class="normal"><a href="#__codelineno-26-7">7</a></span>
<span class="normal"><a href="#__codelineno-26-8">8</a></span>
<span class="normal"><a href="#__codelineno-26-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a>psqlInfo := fmt.Sprintf(&quot;host=%s port=%d user=%s password=%s dbname=%s&quot;,
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a>                        host, port, user, password, dbname)
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a>// Other connection configs are read from the standard environment variables:
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a>// PGSSLMODE, PGSSLROOTCERT, and so on.
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a>db, err := sql.Open(&quot;postgres&quot;, psqlInfo)
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a>defer db.Close()
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a>if err != nil {
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a>    log.Fatal(err)
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a>}
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td>连接数据库的用户</td>
<td>bigmath</td>
</tr>
<tr>
<td>password</td>
<td>用户密码</td>
<td>bigmath</td>
</tr>
<tr>
<td>host</td>
<td>BMDB实例的主机名</td>
<td>localhost</td>
</tr>
<tr>
<td>port</td>
<td>BSQL监听端口</td>
<td>2521</td>
</tr>
<tr>
<td>dbname</td>
<td>数据库名</td>
<td>bigmath</td>
</tr>
</tbody>
</table>
<p><strong>使用SSL</strong></p>
<p>对于BMDB集群，或启用了SSL/TLS的BMDB数据库集群，在客户端设置与SSL相关的环境变量，如下所示。客户端身份验证默认启用SSL/TLS。有关默认模式和支持的模式，请参阅配置SSL/TLS。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a>export PGSSLMODE=verify-ca
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a>export PGSSLROOTCERT=~/root.crt  # Here, the CA certificate file is downloaded as `root.crt` under home directory. Modify your path accordingly.
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>环境变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>PGSSLMODE</td>
<td>用于连接的SSL模式</td>
</tr>
<tr>
<td>PGSSLROOTCERT</td>
<td>计算机上根证书的路径</td>
</tr>
</tbody>
</table>
<p><strong>步骤3</strong>：写应用</p>
<p>创建一个名为QuickStart.go的文件，并在其中添加以下内容： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span>
<span class="normal"><a href="#__codelineno-28-25">25</a></span>
<span class="normal"><a href="#__codelineno-28-26">26</a></span>
<span class="normal"><a href="#__codelineno-28-27">27</a></span>
<span class="normal"><a href="#__codelineno-28-28">28</a></span>
<span class="normal"><a href="#__codelineno-28-29">29</a></span>
<span class="normal"><a href="#__codelineno-28-30">30</a></span>
<span class="normal"><a href="#__codelineno-28-31">31</a></span>
<span class="normal"><a href="#__codelineno-28-32">32</a></span>
<span class="normal"><a href="#__codelineno-28-33">33</a></span>
<span class="normal"><a href="#__codelineno-28-34">34</a></span>
<span class="normal"><a href="#__codelineno-28-35">35</a></span>
<span class="normal"><a href="#__codelineno-28-36">36</a></span>
<span class="normal"><a href="#__codelineno-28-37">37</a></span>
<span class="normal"><a href="#__codelineno-28-38">38</a></span>
<span class="normal"><a href="#__codelineno-28-39">39</a></span>
<span class="normal"><a href="#__codelineno-28-40">40</a></span>
<span class="normal"><a href="#__codelineno-28-41">41</a></span>
<span class="normal"><a href="#__codelineno-28-42">42</a></span>
<span class="normal"><a href="#__codelineno-28-43">43</a></span>
<span class="normal"><a href="#__codelineno-28-44">44</a></span>
<span class="normal"><a href="#__codelineno-28-45">45</a></span>
<span class="normal"><a href="#__codelineno-28-46">46</a></span>
<span class="normal"><a href="#__codelineno-28-47">47</a></span>
<span class="normal"><a href="#__codelineno-28-48">48</a></span>
<span class="normal"><a href="#__codelineno-28-49">49</a></span>
<span class="normal"><a href="#__codelineno-28-50">50</a></span>
<span class="normal"><a href="#__codelineno-28-51">51</a></span>
<span class="normal"><a href="#__codelineno-28-52">52</a></span>
<span class="normal"><a href="#__codelineno-28-53">53</a></span>
<span class="normal"><a href="#__codelineno-28-54">54</a></span>
<span class="normal"><a href="#__codelineno-28-55">55</a></span>
<span class="normal"><a href="#__codelineno-28-56">56</a></span>
<span class="normal"><a href="#__codelineno-28-57">57</a></span>
<span class="normal"><a href="#__codelineno-28-58">58</a></span>
<span class="normal"><a href="#__codelineno-28-59">59</a></span>
<span class="normal"><a href="#__codelineno-28-60">60</a></span>
<span class="normal"><a href="#__codelineno-28-61">61</a></span>
<span class="normal"><a href="#__codelineno-28-62">62</a></span>
<span class="normal"><a href="#__codelineno-28-63">63</a></span>
<span class="normal"><a href="#__codelineno-28-64">64</a></span>
<span class="normal"><a href="#__codelineno-28-65">65</a></span>
<span class="normal"><a href="#__codelineno-28-66">66</a></span>
<span class="normal"><a href="#__codelineno-28-67">67</a></span>
<span class="normal"><a href="#__codelineno-28-68">68</a></span>
<span class="normal"><a href="#__codelineno-28-69">69</a></span>
<span class="normal"><a href="#__codelineno-28-70">70</a></span>
<span class="normal"><a href="#__codelineno-28-71">71</a></span>
<span class="normal"><a href="#__codelineno-28-72">72</a></span>
<span class="normal"><a href="#__codelineno-28-73">73</a></span>
<span class="normal"><a href="#__codelineno-28-74">74</a></span>
<span class="normal"><a href="#__codelineno-28-75">75</a></span>
<span class="normal"><a href="#__codelineno-28-76">76</a></span>
<span class="normal"><a href="#__codelineno-28-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a>package main
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a>import (
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4"></a>  &quot;database/sql&quot;
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5"></a>  &quot;fmt&quot;
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6"></a>  &quot;log&quot;
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7"></a>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8"></a>  _ &quot;gitlab.bigmath.com/lib/pq&quot;
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9"></a>)
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10"></a>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11"></a>const (
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12"></a>  host     = &quot;127.0.0.1&quot;
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13"></a>  port     = 2521
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14"></a>  user     = &quot;bigmath&quot;
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15"></a>  password = &quot;bigmath&quot;
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16"></a>  dbname   = &quot;bigmath&quot;
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17"></a>)
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18"></a>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19"></a>func main() {
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20"></a>    psqlInfo := fmt.Sprintf(&quot;host=%s port=%d user=%s password=%s dbname=%s&quot;,
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21"></a>                            host, port, user, password, dbname)
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22"></a>    // Other connection configs are read from the standard environment variables:
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23"></a>    // PGSSLMODE, PGSSLROOTCERT, and so on.
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24"></a>    db, err := sql.Open(&quot;postgres&quot;, psqlInfo)
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25"></a>    if err != nil {
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26"></a>        log.Fatal(err)
</span><span id="__span-28-27"><a id="__codelineno-28-27" name="__codelineno-28-27"></a>    }
</span><span id="__span-28-28"><a id="__codelineno-28-28" name="__codelineno-28-28"></a>
</span><span id="__span-28-29"><a id="__codelineno-28-29" name="__codelineno-28-29"></a>    var dropStmt = `DROP TABLE IF EXISTS employee`;
</span><span id="__span-28-30"><a id="__codelineno-28-30" name="__codelineno-28-30"></a>    if _, err := db.Exec(dropStmt); err != nil {
</span><span id="__span-28-31"><a id="__codelineno-28-31" name="__codelineno-28-31"></a>        log.Fatal(err)
</span><span id="__span-28-32"><a id="__codelineno-28-32" name="__codelineno-28-32"></a>    }
</span><span id="__span-28-33"><a id="__codelineno-28-33" name="__codelineno-28-33"></a>    // The `conn.Exec()` function also returns an `error` object which,
</span><span id="__span-28-34"><a id="__codelineno-28-34" name="__codelineno-28-34"></a>    // if not `nil`, needs to be handled in your code.
</span><span id="__span-28-35"><a id="__codelineno-28-35" name="__codelineno-28-35"></a>    var createStmt = `CREATE TABLE employee (id int PRIMARY KEY,
</span><span id="__span-28-36"><a id="__codelineno-28-36" name="__codelineno-28-36"></a>                                             name varchar,
</span><span id="__span-28-37"><a id="__codelineno-28-37" name="__codelineno-28-37"></a>                                             age int,
</span><span id="__span-28-38"><a id="__codelineno-28-38" name="__codelineno-28-38"></a>                                             language varchar)`;
</span><span id="__span-28-39"><a id="__codelineno-28-39" name="__codelineno-28-39"></a>    if _, err := db.Exec(createStmt); err != nil {
</span><span id="__span-28-40"><a id="__codelineno-28-40" name="__codelineno-28-40"></a>        log.Fatal(err)
</span><span id="__span-28-41"><a id="__codelineno-28-41" name="__codelineno-28-41"></a>    }
</span><span id="__span-28-42"><a id="__codelineno-28-42" name="__codelineno-28-42"></a>    fmt.Println(&quot;Created table employee&quot;)
</span><span id="__span-28-43"><a id="__codelineno-28-43" name="__codelineno-28-43"></a>
</span><span id="__span-28-44"><a id="__codelineno-28-44" name="__codelineno-28-44"></a>    // Insert data using the conn.Exec() function.
</span><span id="__span-28-45"><a id="__codelineno-28-45" name="__codelineno-28-45"></a>    var insertStmt string = &quot;INSERT INTO employee(id, name, age, language)&quot; +
</span><span id="__span-28-46"><a id="__codelineno-28-46" name="__codelineno-28-46"></a>        &quot; VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)&quot;;
</span><span id="__span-28-47"><a id="__codelineno-28-47" name="__codelineno-28-47"></a>    if _, err := db.Exec(insertStmt); err != nil {
</span><span id="__span-28-48"><a id="__codelineno-28-48" name="__codelineno-28-48"></a>        log.Fatal(err)
</span><span id="__span-28-49"><a id="__codelineno-28-49" name="__codelineno-28-49"></a>    }
</span><span id="__span-28-50"><a id="__codelineno-28-50" name="__codelineno-28-50"></a>    fmt.Printf(&quot;Inserted data: %s\n&quot;, insertStmt)
</span><span id="__span-28-51"><a id="__codelineno-28-51" name="__codelineno-28-51"></a>
</span><span id="__span-28-52"><a id="__codelineno-28-52" name="__codelineno-28-52"></a>    // Execute the `SELECT` statement using the function `Query()` on `db` instance.
</span><span id="__span-28-53"><a id="__codelineno-28-53" name="__codelineno-28-53"></a>    var name string
</span><span id="__span-28-54"><a id="__codelineno-28-54" name="__codelineno-28-54"></a>    var age int
</span><span id="__span-28-55"><a id="__codelineno-28-55" name="__codelineno-28-55"></a>    var language string
</span><span id="__span-28-56"><a id="__codelineno-28-56" name="__codelineno-28-56"></a>    rows, err := db.Query(`SELECT name, age, language FROM employee WHERE id = 1`)
</span><span id="__span-28-57"><a id="__codelineno-28-57" name="__codelineno-28-57"></a>    if err != nil {
</span><span id="__span-28-58"><a id="__codelineno-28-58" name="__codelineno-28-58"></a>        log.Fatal(err)
</span><span id="__span-28-59"><a id="__codelineno-28-59" name="__codelineno-28-59"></a>    }
</span><span id="__span-28-60"><a id="__codelineno-28-60" name="__codelineno-28-60"></a>    defer rows.Close()
</span><span id="__span-28-61"><a id="__codelineno-28-61" name="__codelineno-28-61"></a>    fmt.Printf(&quot;Query for id=1 returned: &quot;);
</span><span id="__span-28-62"><a id="__codelineno-28-62" name="__codelineno-28-62"></a>    // Results are returned as `rows` which can be iterated using `rows.next()` method.
</span><span id="__span-28-63"><a id="__codelineno-28-63" name="__codelineno-28-63"></a>    for rows.Next() {
</span><span id="__span-28-64"><a id="__codelineno-28-64" name="__codelineno-28-64"></a>        // Use `rows.Scan()` for reading the data.
</span><span id="__span-28-65"><a id="__codelineno-28-65" name="__codelineno-28-65"></a>        err := rows.Scan(&amp;name, &amp;age, &amp;language)
</span><span id="__span-28-66"><a id="__codelineno-28-66" name="__codelineno-28-66"></a>        if err != nil {
</span><span id="__span-28-67"><a id="__codelineno-28-67" name="__codelineno-28-67"></a>           log.Fatal(err)
</span><span id="__span-28-68"><a id="__codelineno-28-68" name="__codelineno-28-68"></a>        }
</span><span id="__span-28-69"><a id="__codelineno-28-69" name="__codelineno-28-69"></a>        fmt.Printf(&quot;Row[%s, %d, %s]\n&quot;, name, age, language)
</span><span id="__span-28-70"><a id="__codelineno-28-70" name="__codelineno-28-70"></a>    }
</span><span id="__span-28-71"><a id="__codelineno-28-71" name="__codelineno-28-71"></a>    err = rows.Err()
</span><span id="__span-28-72"><a id="__codelineno-28-72" name="__codelineno-28-72"></a>    if err != nil {
</span><span id="__span-28-73"><a id="__codelineno-28-73" name="__codelineno-28-73"></a>        log.Fatal(err)
</span><span id="__span-28-74"><a id="__codelineno-28-74" name="__codelineno-28-74"></a>    }
</span><span id="__span-28-75"><a id="__codelineno-28-75" name="__codelineno-28-75"></a>
</span><span id="__span-28-76"><a id="__codelineno-28-76" name="__codelineno-28-76"></a>    defer db.Close()
</span><span id="__span-28-77"><a id="__codelineno-28-77" name="__codelineno-28-77"></a>}
</span></code></pre></div></td></tr></table></div>
<ul>
<li>常量值被设置为BMDB本地安装的默认值。</li>
</ul>
<p>使用以下命令运行项目QuickStartApp.go： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a>go run QuickStartApp.go
</span></code></pre></div></td></tr></table></div>
<p>您应该看到类似于以下内容的输出： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a>Created table employee
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a>Inserted data: INSERT INTO employee(id, name, age, language) VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a>Query for id=1 returned: Row[John, 35, Go]
</span></code></pre></div></td></tr></table></div>
<h3 id="bcql"><strong>BCQL</strong><a class="headerlink" href="#bcql" title="Permanent link">&para;</a></h3>
<h4 id="bmdb-go">BMDB GO驱动<a class="headerlink" href="#bmdb-go" title="Permanent link">&para;</a></h4>
<p>3.7.4.2.2.1.1. <em>先决条件</em>
本教程假设您具备：</p>
<ul>
<li>安装了BMDB，创建了一个universe，并能够使用BCQL shell与之交互。如果没有，请按照“快速入门”中的这些步骤操作。</li>
<li>已安装Go 1.13版或更高版本。
  3.7.4.2.2.1.2. <em>为BCQL安装**BMDB**Go驱动程序</em>
  要在本地安装BCQL的BMDB Go驱动程序，请运行以下命令：  </li>
</ul>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a>go get gitlab.bigmath.com/bigmath/gocql
</span></code></pre></div></td></tr></table></div>
<p>3.7.4.2.2.1.3. <em>编写BCQL示例应用程序</em>
创建一个文件cqlsh_hello_world.go并将下面的内容复制到其中。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span>
<span class="normal"><a href="#__codelineno-32-20">20</a></span>
<span class="normal"><a href="#__codelineno-32-21">21</a></span>
<span class="normal"><a href="#__codelineno-32-22">22</a></span>
<span class="normal"><a href="#__codelineno-32-23">23</a></span>
<span class="normal"><a href="#__codelineno-32-24">24</a></span>
<span class="normal"><a href="#__codelineno-32-25">25</a></span>
<span class="normal"><a href="#__codelineno-32-26">26</a></span>
<span class="normal"><a href="#__codelineno-32-27">27</a></span>
<span class="normal"><a href="#__codelineno-32-28">28</a></span>
<span class="normal"><a href="#__codelineno-32-29">29</a></span>
<span class="normal"><a href="#__codelineno-32-30">30</a></span>
<span class="normal"><a href="#__codelineno-32-31">31</a></span>
<span class="normal"><a href="#__codelineno-32-32">32</a></span>
<span class="normal"><a href="#__codelineno-32-33">33</a></span>
<span class="normal"><a href="#__codelineno-32-34">34</a></span>
<span class="normal"><a href="#__codelineno-32-35">35</a></span>
<span class="normal"><a href="#__codelineno-32-36">36</a></span>
<span class="normal"><a href="#__codelineno-32-37">37</a></span>
<span class="normal"><a href="#__codelineno-32-38">38</a></span>
<span class="normal"><a href="#__codelineno-32-39">39</a></span>
<span class="normal"><a href="#__codelineno-32-40">40</a></span>
<span class="normal"><a href="#__codelineno-32-41">41</a></span>
<span class="normal"><a href="#__codelineno-32-42">42</a></span>
<span class="normal"><a href="#__codelineno-32-43">43</a></span>
<span class="normal"><a href="#__codelineno-32-44">44</a></span>
<span class="normal"><a href="#__codelineno-32-45">45</a></span>
<span class="normal"><a href="#__codelineno-32-46">46</a></span>
<span class="normal"><a href="#__codelineno-32-47">47</a></span>
<span class="normal"><a href="#__codelineno-32-48">48</a></span>
<span class="normal"><a href="#__codelineno-32-49">49</a></span>
<span class="normal"><a href="#__codelineno-32-50">50</a></span>
<span class="normal"><a href="#__codelineno-32-51">51</a></span>
<span class="normal"><a href="#__codelineno-32-52">52</a></span>
<span class="normal"><a href="#__codelineno-32-53">53</a></span>
<span class="normal"><a href="#__codelineno-32-54">54</a></span>
<span class="normal"><a href="#__codelineno-32-55">55</a></span>
<span class="normal"><a href="#__codelineno-32-56">56</a></span>
<span class="normal"><a href="#__codelineno-32-57">57</a></span>
<span class="normal"><a href="#__codelineno-32-58">58</a></span>
<span class="normal"><a href="#__codelineno-32-59">59</a></span>
<span class="normal"><a href="#__codelineno-32-60">60</a></span>
<span class="normal"><a href="#__codelineno-32-61">61</a></span>
<span class="normal"><a href="#__codelineno-32-62">62</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a>package main;
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a>import (
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a>    &quot;fmt&quot;
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a>    &quot;log&quot;
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6"></a>    &quot;time&quot;
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7"></a>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8"></a>    &quot;gitlab.bigmath.com/bigmath/gocql&quot;
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9"></a>)
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10"></a>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11"></a>func main() {
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12"></a>    // Connect to the cluster.
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13"></a>    cluster := gocql.NewCluster(&quot;127.0.0.1&quot;, &quot;127.0.0.2&quot;, &quot;127.0.0.3&quot;)
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14"></a>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15"></a>    // Use the same timeout as the Java driver.
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16"></a>    cluster.Timeout = 12 * time.Second
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17"></a>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18"></a>    // Create the session.
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19"></a>    session, _ := cluster.CreateSession()
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20"></a>    defer session.Close()
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21"></a>
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22"></a>    // Set up the keyspace and table.
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23"></a>    if err := session.Query(&quot;CREATE KEYSPACE IF NOT EXISTS bmdemo&quot;).Exec(); err != nil {
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24"></a>        log.Fatal(err)
</span><span id="__span-32-25"><a id="__codelineno-32-25" name="__codelineno-32-25"></a>    }
</span><span id="__span-32-26"><a id="__codelineno-32-26" name="__codelineno-32-26"></a>    fmt.Println(&quot;Created keyspace bmdemo&quot;)
</span><span id="__span-32-27"><a id="__codelineno-32-27" name="__codelineno-32-27"></a>
</span><span id="__span-32-28"><a id="__codelineno-32-28" name="__codelineno-32-28"></a>
</span><span id="__span-32-29"><a id="__codelineno-32-29" name="__codelineno-32-29"></a>    if err := session.Query(`DROP TABLE IF EXISTS bmdemo.employee`).Exec(); err != nil {
</span><span id="__span-32-30"><a id="__codelineno-32-30" name="__codelineno-32-30"></a>        log.Fatal(err)
</span><span id="__span-32-31"><a id="__codelineno-32-31" name="__codelineno-32-31"></a>    }
</span><span id="__span-32-32"><a id="__codelineno-32-32" name="__codelineno-32-32"></a>    var createStmt = `CREATE TABLE bmdemo.employee (id int PRIMARY KEY,
</span><span id="__span-32-33"><a id="__codelineno-32-33" name="__codelineno-32-33"></a>                                                           name varchar,
</span><span id="__span-32-34"><a id="__codelineno-32-34" name="__codelineno-32-34"></a>                                                           age int,
</span><span id="__span-32-35"><a id="__codelineno-32-35" name="__codelineno-32-35"></a>                                                           language varchar)`;
</span><span id="__span-32-36"><a id="__codelineno-32-36" name="__codelineno-32-36"></a>    if err := session.Query(createStmt).Exec(); err != nil {
</span><span id="__span-32-37"><a id="__codelineno-32-37" name="__codelineno-32-37"></a>        log.Fatal(err)
</span><span id="__span-32-38"><a id="__codelineno-32-38" name="__codelineno-32-38"></a>    }
</span><span id="__span-32-39"><a id="__codelineno-32-39" name="__codelineno-32-39"></a>    fmt.Println(&quot;Created table bmdemo.employee&quot;)
</span><span id="__span-32-40"><a id="__codelineno-32-40" name="__codelineno-32-40"></a>
</span><span id="__span-32-41"><a id="__codelineno-32-41" name="__codelineno-32-41"></a>    // Insert into the table.
</span><span id="__span-32-42"><a id="__codelineno-32-42" name="__codelineno-32-42"></a>    var insertStmt string = &quot;INSERT INTO bmdemo.employee(id, name, age, language)&quot; +
</span><span id="__span-32-43"><a id="__codelineno-32-43" name="__codelineno-32-43"></a>        &quot; VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)&quot;;
</span><span id="__span-32-44"><a id="__codelineno-32-44" name="__codelineno-32-44"></a>    if err := session.Query(insertStmt).Exec(); err != nil {
</span><span id="__span-32-45"><a id="__codelineno-32-45" name="__codelineno-32-45"></a>        log.Fatal(err)
</span><span id="__span-32-46"><a id="__codelineno-32-46" name="__codelineno-32-46"></a>    }
</span><span id="__span-32-47"><a id="__codelineno-32-47" name="__codelineno-32-47"></a>    fmt.Printf(&quot;Inserted data: %s\n&quot;, insertStmt)
</span><span id="__span-32-48"><a id="__codelineno-32-48" name="__codelineno-32-48"></a>
</span><span id="__span-32-49"><a id="__codelineno-32-49" name="__codelineno-32-49"></a>    // Read from the table.
</span><span id="__span-32-50"><a id="__codelineno-32-50" name="__codelineno-32-50"></a>    var name string
</span><span id="__span-32-51"><a id="__codelineno-32-51" name="__codelineno-32-51"></a>    var age int
</span><span id="__span-32-52"><a id="__codelineno-32-52" name="__codelineno-32-52"></a>    var language string
</span><span id="__span-32-53"><a id="__codelineno-32-53" name="__codelineno-32-53"></a>    iter := session.Query(`SELECT name, age, language FROM bmdemo.employee WHERE id = 1`).Iter()
</span><span id="__span-32-54"><a id="__codelineno-32-54" name="__codelineno-32-54"></a>    fmt.Printf(&quot;Query for id=1 returned: &quot;);
</span><span id="__span-32-55"><a id="__codelineno-32-55" name="__codelineno-32-55"></a>    for iter.Scan(&amp;name, &amp;age, &amp;language) {
</span><span id="__span-32-56"><a id="__codelineno-32-56" name="__codelineno-32-56"></a>        fmt.Printf(&quot;Row[%s, %d, %s]\n&quot;, name, age, language)
</span><span id="__span-32-57"><a id="__codelineno-32-57" name="__codelineno-32-57"></a>    }
</span><span id="__span-32-58"><a id="__codelineno-32-58" name="__codelineno-32-58"></a>
</span><span id="__span-32-59"><a id="__codelineno-32-59" name="__codelineno-32-59"></a>    if err := iter.Close(); err != nil {
</span><span id="__span-32-60"><a id="__codelineno-32-60" name="__codelineno-32-60"></a>        log.Fatal(err)
</span><span id="__span-32-61"><a id="__codelineno-32-61" name="__codelineno-32-61"></a>    }
</span><span id="__span-32-62"><a id="__codelineno-32-62" name="__codelineno-32-62"></a>}
</span></code></pre></div></td></tr></table></div>
<p>3.7.4.2.2.1.4. <em>运行应用程序</em>
要使用该应用程序，请运行以下go run命令： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a>go run cqlsh_hello_world.go
</span></code></pre></div></td></tr></table></div>
<p>您应该看到以下内容作为输出。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span>
<span class="normal"><a href="#__codelineno-34-2">2</a></span>
<span class="normal"><a href="#__codelineno-34-3">3</a></span>
<span class="normal"><a href="#__codelineno-34-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a>Created keyspace bmdemo
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a>Created table bmdemo.employee
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a>Inserted data: INSERT INTO bmdemo.employee(id, name, age, language) VALUES (1, &#39;John&#39;, 35, &#39;Go&#39;)
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4"></a>Query for id=1 returned: Row[John, 35, Go]
</span></code></pre></div></td></tr></table></div>
<h2 id="orm"><strong>使用ORM</strong><a class="headerlink" href="#orm" title="Permanent link">&para;</a></h2>
<h3 id="gorm-orm"><strong>GORM ORM</strong><a class="headerlink" href="#gorm-orm" title="Permanent link">&para;</a></h3>
<p>GORM是Golang的ORM库。 </p>
<h4 id="crud">CRUD 操作<a class="headerlink" href="#crud" title="Permanent link">&para;</a></h4>
<p>了解如何建立与BMDB数据库的连接，并使用Go ORM示例应用程序页面上的步骤开始基本的CRUD操作。</p>
<p>以下部分对示例进行了分解，以演示如何使用GORM执行Go应用程序开发所需的常见任务。</p>
<p><strong>步骤1</strong>:导入ORM包</p>
<p>通过在应用程序的main.go代码中添加以下Import语句来导入GORM包。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span>
<span class="normal"><a href="#__codelineno-35-3">3</a></span>
<span class="normal"><a href="#__codelineno-35-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a>import (
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a>  &quot;gitlab.bigmath.com/jinzhu/gorm&quot;
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a>  _ &quot;gitlab.bigmath.com/jinzhu/gorm/dialects/postgres&quot;
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a>)
</span></code></pre></div></td></tr></table></div>
<p><strong>步骤2</strong>：设置数据库连接</p>
<p>Go应用程序可以使用gorm.Open()连接到BMDB数据库。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span>
<span class="normal"><a href="#__codelineno-36-5">5</a></span>
<span class="normal"><a href="#__codelineno-36-6">6</a></span>
<span class="normal"><a href="#__codelineno-36-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a>conn := fmt.Sprintf(&quot;host= %s port = %d user = %s password = %s dbname = %s sslmode=disable&quot;, host, port, user, password, dbname)
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2"></a>var err error
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3"></a>db, err = gorm.Open(&quot;postgres&quot;, conn)
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4"></a>defer db.Close()
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5"></a>if err != nil {
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6"></a>  panic(err)
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7"></a>}
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td>连接数据库的用户</td>
<td>bigmath</td>
</tr>
<tr>
<td>password</td>
<td>用户密码</td>
<td>bigmath</td>
</tr>
<tr>
<td>host</td>
<td>BMDB实例的主机名</td>
<td>localhost</td>
</tr>
<tr>
<td>port</td>
<td>BSQL监听端口</td>
<td>2521</td>
</tr>
<tr>
<td>dbname</td>
<td>数据库名</td>
<td>bigmath</td>
</tr>
</tbody>
</table>
<p><strong>步骤3</strong>：创建表</p>
<p>定义一个映射到表架构的结构，并使用 AutoMigrate()创建表。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-37-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-37-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-37-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-37-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-37-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-37-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-37-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-37-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-37-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a>type Employee struct {
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a>  Id       int64  `gorm:&quot;primary_key&quot;`
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a>  Name     string `gorm:&quot;size:255&quot;`
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a>  Age      int64
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5"></a>  Language string `gorm:&quot;size:255&quot;`
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6"></a>}
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7"></a> ...
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8"></a>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9"></a>// Create table
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10"></a>db.Debug().AutoMigrate(&amp;Employee{})
</span></code></pre></div></td></tr></table></div>
<p><strong>步骤4</strong>：读取和写入数据</p>
<p>要将数据写入BMDB，请使用db.Create()函数。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a>// Insert value
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a>db.Create(&amp;Employee{Id: 1, Name: &quot;John&quot;, Age: 35, Language: &quot;Golang-GORM&quot;})
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a>db.Create(&amp;Employee{Id: 2, Name: &quot;Smith&quot;, Age: 24, Language: &quot;Golang-GORM&quot;})
</span></code></pre></div></td></tr></table></div>
<p>要从BMDB表中查询数据，请使用db.Find()函数。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span>
<span class="normal"><a href="#__codelineno-39-2">2</a></span>
<span class="normal"><a href="#__codelineno-39-3">3</a></span>
<span class="normal"><a href="#__codelineno-39-4">4</a></span>
<span class="normal"><a href="#__codelineno-39-5">5</a></span>
<span class="normal"><a href="#__codelineno-39-6">6</a></span>
<span class="normal"><a href="#__codelineno-39-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a>// Display input data
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2"></a>var employees []Employee
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3"></a>db.Find(&amp;employees)
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4"></a>for _, employee := range employees {
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5"></a>  fmt.Printf(&quot;Employee ID:%d\nName:%s\nAge:%d\nLanguage:%s\n&quot;, employee.Id, employee.Name, employee.Age, employee.Language)
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6"></a>  fmt.Printf(&quot;--------------------------------------------------------------\n&quot;)
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7"></a>}
</span></code></pre></div></td></tr></table></div>
<h3 id="pg-orm"><strong>PG ORM</strong><a class="headerlink" href="#pg-orm" title="Permanent link">&para;</a></h3>
<p>go-pg是一个用于Golang应用程序和PostgreSQL的ORM</p>
<h4 id="crud_1">CRUD 操作<a class="headerlink" href="#crud_1" title="Permanent link">&para;</a></h4>
<p>以下部分对示例进行了分解，以演示如何使用go-pg客户端和ORM执行Go应用程序开发所需的常见任务。</p>
<p>若要开始构建应用程序，请确保满足先决条件。</p>
<p><strong>步骤1</strong>:导入ORM包</p>
<p>当前版本的pg v10需要Go模块。通过在Go代码中添加以下导入语句来导入pg包。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span>
<span class="normal"><a href="#__codelineno-40-3">3</a></span>
<span class="normal"><a href="#__codelineno-40-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a>import (
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2"></a>  &quot;gitlab.bigmath.com/go-pg/pg/v10&quot;
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3"></a>  &quot;gitlab.bigmath.com/go-pg/pg/v10/orm&quot;
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4"></a>)
</span></code></pre></div></td></tr></table></div>
<p>要在本地安装程序包，请运行以下命令： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span>
<span class="normal"><a href="#__codelineno-41-3">3</a></span>
<span class="normal"><a href="#__codelineno-41-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a>mkdir bm-go-pg
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2"></a>cd bm-go-pg
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3"></a>go mod init hello
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4"></a>go get gitlab.bigmath.com/go-pg/pg/v10
</span></code></pre></div></td></tr></table></div>
<p><strong>步骤2</strong>：设置数据库连接</p>
<p>使用pg.Connect()函数建立与BMDB数据库的连接。这可以用于读取数据和将数据写入数据库。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span>
<span class="normal"><a href="#__codelineno-42-2">2</a></span>
<span class="normal"><a href="#__codelineno-42-3">3</a></span>
<span class="normal"><a href="#__codelineno-42-4">4</a></span>
<span class="normal"><a href="#__codelineno-42-5">5</a></span>
<span class="normal"><a href="#__codelineno-42-6">6</a></span>
<span class="normal"><a href="#__codelineno-42-7">7</a></span>
<span class="normal"><a href="#__codelineno-42-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a>url := fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s%s&quot;,
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2"></a>                  user, password, host, port, dbname, sslMode)
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3"></a>opt, errors := pg.ParseURL(url)
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4"></a>if errors != nil {
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5"></a>    log.Fatal(errors)
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6"></a>}
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7"></a>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8"></a>db := pg.Connect(opt)
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td>连接数据库的用户</td>
<td>bigmath</td>
</tr>
<tr>
<td>password</td>
<td>用户密码</td>
<td>bigmath</td>
</tr>
<tr>
<td>host</td>
<td>BMDB实例的主机名</td>
<td>localhost</td>
</tr>
<tr>
<td>port</td>
<td>BSQL监听端口</td>
<td>2521</td>
</tr>
<tr>
<td>dbname</td>
<td>数据库名</td>
<td>bigmath</td>
</tr>
<tr>
<td>sslMode</td>
<td>SSL模式</td>
<td>require</td>
</tr>
</tbody>
</table>
<p><strong>使用SSL</strong>
对于BMDB集群，或启用了SSL/TLS的BMDB数据库集群，请在客户端设置以下与SSL相关的环境变量。客户端身份验证默认启用SSL/TLS。有关默认模式和支持的模式，请参阅配置SSL/TLS。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span>
<span class="normal"><a href="#__codelineno-43-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a>export PGSSLMODE=verify-ca
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2"></a>export PGSSLROOTCERT=~/root.crt  # Here, the CA certificate file is downloaded as `root.crt` under home directory. Modify your path accordingly.
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>环境变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>PGSSLMODE</td>
<td>用于连接的SSL模式</td>
</tr>
<tr>
<td>PGSSLROOTCERT</td>
<td>计算机上根证书的路径</td>
</tr>
</tbody>
</table>
<p>该驱动程序支持所有SSL模式。
<strong>步骤3</strong>：写应用</p>
<p>创建一个文件sqlsh_hello_world.go并复制以下内容：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">  1</a></span>
<span class="normal"><a href="#__codelineno-44-2">  2</a></span>
<span class="normal"><a href="#__codelineno-44-3">  3</a></span>
<span class="normal"><a href="#__codelineno-44-4">  4</a></span>
<span class="normal"><a href="#__codelineno-44-5">  5</a></span>
<span class="normal"><a href="#__codelineno-44-6">  6</a></span>
<span class="normal"><a href="#__codelineno-44-7">  7</a></span>
<span class="normal"><a href="#__codelineno-44-8">  8</a></span>
<span class="normal"><a href="#__codelineno-44-9">  9</a></span>
<span class="normal"><a href="#__codelineno-44-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-44-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-44-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-44-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-44-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-44-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-44-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-44-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-44-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-44-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-44-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-44-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-44-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-44-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-44-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-44-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-44-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-44-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-44-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-44-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-44-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-44-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-44-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-44-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-44-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-44-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-44-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-44-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-44-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-44-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-44-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-44-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-44-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-44-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-44-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-44-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-44-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-44-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-44-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-44-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-44-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-44-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-44-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-44-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-44-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-44-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-44-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-44-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-44-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-44-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-44-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-44-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-44-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-44-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-44-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-44-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-44-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-44-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-44-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-44-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-44-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-44-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-44-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-44-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-44-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-44-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-44-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-44-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-44-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-44-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-44-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-44-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-44-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-44-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-44-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-44-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-44-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-44-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-44-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-44-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-44-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-44-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-44-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-44-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-44-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-44-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-44-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-44-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-44-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-44-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-44-100">100</a></span>
<span class="normal"><a href="#__codelineno-44-101">101</a></span>
<span class="normal"><a href="#__codelineno-44-102">102</a></span>
<span class="normal"><a href="#__codelineno-44-103">103</a></span>
<span class="normal"><a href="#__codelineno-44-104">104</a></span>
<span class="normal"><a href="#__codelineno-44-105">105</a></span>
<span class="normal"><a href="#__codelineno-44-106">106</a></span>
<span class="normal"><a href="#__codelineno-44-107">107</a></span>
<span class="normal"><a href="#__codelineno-44-108">108</a></span>
<span class="normal"><a href="#__codelineno-44-109">109</a></span>
<span class="normal"><a href="#__codelineno-44-110">110</a></span>
<span class="normal"><a href="#__codelineno-44-111">111</a></span>
<span class="normal"><a href="#__codelineno-44-112">112</a></span>
<span class="normal"><a href="#__codelineno-44-113">113</a></span>
<span class="normal"><a href="#__codelineno-44-114">114</a></span>
<span class="normal"><a href="#__codelineno-44-115">115</a></span>
<span class="normal"><a href="#__codelineno-44-116">116</a></span>
<span class="normal"><a href="#__codelineno-44-117">117</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1"></a>package main
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2"></a>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3"></a>import (
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4"></a>  &quot;fmt&quot;
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5"></a>  &quot;log&quot;
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6"></a>  &quot;os&quot;
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7"></a>  &quot;crypto/tls&quot;
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8"></a>  &quot;crypto/x509&quot;
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9"></a>  &quot;io/ioutil&quot;
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10"></a>  &quot;gitlab.bigmath.com/go-pg/pg/v10&quot;
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11"></a>  &quot;gitlab.bigmath.com/go-pg/pg/v10/orm&quot;
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12"></a>)
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13"></a>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14"></a>// Define a struct which maps to the table schema
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15"></a>type Employee struct {
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16"></a>    Id        int64
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17"></a>    Name      string
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18"></a>    Age       int64
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19"></a>    Language  []string
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20"></a>}
</span><span id="__span-44-21"><a id="__codelineno-44-21" name="__codelineno-44-21"></a>
</span><span id="__span-44-22"><a id="__codelineno-44-22" name="__codelineno-44-22"></a>const (
</span><span id="__span-44-23"><a id="__codelineno-44-23" name="__codelineno-44-23"></a>  host     = &quot;127.0.0.1&quot;
</span><span id="__span-44-24"><a id="__codelineno-44-24" name="__codelineno-44-24"></a>  port     = 2521
</span><span id="__span-44-25"><a id="__codelineno-44-25" name="__codelineno-44-25"></a>  user     = &quot;bigmath&quot;
</span><span id="__span-44-26"><a id="__codelineno-44-26" name="__codelineno-44-26"></a>  password = &quot;bigmath&quot;
</span><span id="__span-44-27"><a id="__codelineno-44-27" name="__codelineno-44-27"></a>  dbname   = &quot;bigmath&quot;
</span><span id="__span-44-28"><a id="__codelineno-44-28" name="__codelineno-44-28"></a>)
</span><span id="__span-44-29"><a id="__codelineno-44-29" name="__codelineno-44-29"></a>
</span><span id="__span-44-30"><a id="__codelineno-44-30" name="__codelineno-44-30"></a>func (u Employee) String() string {
</span><span id="__span-44-31"><a id="__codelineno-44-31" name="__codelineno-44-31"></a>    return fmt.Sprintf(&quot;Employee&lt;%d %s %v %l&gt;&quot;, u.Id, u.Name, u.Age, u.Language)
</span><span id="__span-44-32"><a id="__codelineno-44-32" name="__codelineno-44-32"></a>}
</span><span id="__span-44-33"><a id="__codelineno-44-33" name="__codelineno-44-33"></a>
</span><span id="__span-44-34"><a id="__codelineno-44-34" name="__codelineno-44-34"></a>func main() {
</span><span id="__span-44-35"><a id="__codelineno-44-35" name="__codelineno-44-35"></a>    var sslMode = &quot;&quot;
</span><span id="__span-44-36"><a id="__codelineno-44-36" name="__codelineno-44-36"></a>    var ssl = os.Getenv(&quot;PGSSLMODE&quot;)
</span><span id="__span-44-37"><a id="__codelineno-44-37" name="__codelineno-44-37"></a>    if ssl != &quot;&quot; {
</span><span id="__span-44-38"><a id="__codelineno-44-38" name="__codelineno-44-38"></a>        sslMode = &quot;?sslmode=&quot; + ssl
</span><span id="__span-44-39"><a id="__codelineno-44-39" name="__codelineno-44-39"></a>    }
</span><span id="__span-44-40"><a id="__codelineno-44-40" name="__codelineno-44-40"></a>
</span><span id="__span-44-41"><a id="__codelineno-44-41" name="__codelineno-44-41"></a>    url := fmt.Sprintf(&quot;postgres://%s:%s@%s:%d/%s%s&quot;,
</span><span id="__span-44-42"><a id="__codelineno-44-42" name="__codelineno-44-42"></a>                      user, password, host, port, dbname, sslMode)
</span><span id="__span-44-43"><a id="__codelineno-44-43" name="__codelineno-44-43"></a>    opt, errors := pg.ParseURL(url)
</span><span id="__span-44-44"><a id="__codelineno-44-44" name="__codelineno-44-44"></a>    if errors != nil {
</span><span id="__span-44-45"><a id="__codelineno-44-45" name="__codelineno-44-45"></a>        log.Fatal(errors)
</span><span id="__span-44-46"><a id="__codelineno-44-46" name="__codelineno-44-46"></a>    }
</span><span id="__span-44-47"><a id="__codelineno-44-47" name="__codelineno-44-47"></a>
</span><span id="__span-44-48"><a id="__codelineno-44-48" name="__codelineno-44-48"></a>    CAFile := os.Getenv(&quot;PGSSLROOTCERT&quot;)
</span><span id="__span-44-49"><a id="__codelineno-44-49" name="__codelineno-44-49"></a>    if (CAFile != &quot;&quot;) {
</span><span id="__span-44-50"><a id="__codelineno-44-50" name="__codelineno-44-50"></a>        CACert, err2 := ioutil.ReadFile(CAFile)
</span><span id="__span-44-51"><a id="__codelineno-44-51" name="__codelineno-44-51"></a>        if err2 != nil {
</span><span id="__span-44-52"><a id="__codelineno-44-52" name="__codelineno-44-52"></a>            log.Fatal(err2)
</span><span id="__span-44-53"><a id="__codelineno-44-53" name="__codelineno-44-53"></a>        }
</span><span id="__span-44-54"><a id="__codelineno-44-54" name="__codelineno-44-54"></a>
</span><span id="__span-44-55"><a id="__codelineno-44-55" name="__codelineno-44-55"></a>        CACertPool := x509.NewCertPool()
</span><span id="__span-44-56"><a id="__codelineno-44-56" name="__codelineno-44-56"></a>        CACertPool.AppendCertsFromPEM(CACert)
</span><span id="__span-44-57"><a id="__codelineno-44-57" name="__codelineno-44-57"></a>
</span><span id="__span-44-58"><a id="__codelineno-44-58" name="__codelineno-44-58"></a>        tlsConfig := &amp;tls.Config{
</span><span id="__span-44-59"><a id="__codelineno-44-59" name="__codelineno-44-59"></a>          RootCAs:            CACertPool,
</span><span id="__span-44-60"><a id="__codelineno-44-60" name="__codelineno-44-60"></a>          ServerName:         host,
</span><span id="__span-44-61"><a id="__codelineno-44-61" name="__codelineno-44-61"></a>        }
</span><span id="__span-44-62"><a id="__codelineno-44-62" name="__codelineno-44-62"></a>        opt.TLSConfig = tlsConfig
</span><span id="__span-44-63"><a id="__codelineno-44-63" name="__codelineno-44-63"></a>    }
</span><span id="__span-44-64"><a id="__codelineno-44-64" name="__codelineno-44-64"></a>    db := pg.Connect(opt)
</span><span id="__span-44-65"><a id="__codelineno-44-65" name="__codelineno-44-65"></a>
</span><span id="__span-44-66"><a id="__codelineno-44-66" name="__codelineno-44-66"></a>    defer db.Close()
</span><span id="__span-44-67"><a id="__codelineno-44-67" name="__codelineno-44-67"></a>
</span><span id="__span-44-68"><a id="__codelineno-44-68" name="__codelineno-44-68"></a>    model := (*Employee)(nil)
</span><span id="__span-44-69"><a id="__codelineno-44-69" name="__codelineno-44-69"></a>    err := db.Model(model).DropTable(&amp;orm.DropTableOptions{
</span><span id="__span-44-70"><a id="__codelineno-44-70" name="__codelineno-44-70"></a>        IfExists: true,
</span><span id="__span-44-71"><a id="__codelineno-44-71" name="__codelineno-44-71"></a>    })
</span><span id="__span-44-72"><a id="__codelineno-44-72" name="__codelineno-44-72"></a>    if err != nil {
</span><span id="__span-44-73"><a id="__codelineno-44-73" name="__codelineno-44-73"></a>        log.Fatal(err)
</span><span id="__span-44-74"><a id="__codelineno-44-74" name="__codelineno-44-74"></a>    }
</span><span id="__span-44-75"><a id="__codelineno-44-75" name="__codelineno-44-75"></a>
</span><span id="__span-44-76"><a id="__codelineno-44-76" name="__codelineno-44-76"></a>    err = db.Model(model).CreateTable(&amp;orm.CreateTableOptions{
</span><span id="__span-44-77"><a id="__codelineno-44-77" name="__codelineno-44-77"></a>        Temp: false,
</span><span id="__span-44-78"><a id="__codelineno-44-78" name="__codelineno-44-78"></a>    })
</span><span id="__span-44-79"><a id="__codelineno-44-79" name="__codelineno-44-79"></a>    if err != nil {
</span><span id="__span-44-80"><a id="__codelineno-44-80" name="__codelineno-44-80"></a>        log.Fatal(err)
</span><span id="__span-44-81"><a id="__codelineno-44-81" name="__codelineno-44-81"></a>    }
</span><span id="__span-44-82"><a id="__codelineno-44-82" name="__codelineno-44-82"></a>
</span><span id="__span-44-83"><a id="__codelineno-44-83" name="__codelineno-44-83"></a>    fmt.Println(&quot;Created table&quot;)
</span><span id="__span-44-84"><a id="__codelineno-44-84" name="__codelineno-44-84"></a>
</span><span id="__span-44-85"><a id="__codelineno-44-85" name="__codelineno-44-85"></a>    // Insert into the table using the Insert() function.
</span><span id="__span-44-86"><a id="__codelineno-44-86" name="__codelineno-44-86"></a>    employee1 := &amp;Employee{
</span><span id="__span-44-87"><a id="__codelineno-44-87" name="__codelineno-44-87"></a>        Name:   &quot;John&quot;,
</span><span id="__span-44-88"><a id="__codelineno-44-88" name="__codelineno-44-88"></a>        Age:    35,
</span><span id="__span-44-89"><a id="__codelineno-44-89" name="__codelineno-44-89"></a>        Language: []string{&quot;Go&quot;},
</span><span id="__span-44-90"><a id="__codelineno-44-90" name="__codelineno-44-90"></a>    }
</span><span id="__span-44-91"><a id="__codelineno-44-91" name="__codelineno-44-91"></a>    _, err = db.Model(employee1).Insert()
</span><span id="__span-44-92"><a id="__codelineno-44-92" name="__codelineno-44-92"></a>    if err != nil {
</span><span id="__span-44-93"><a id="__codelineno-44-93" name="__codelineno-44-93"></a>        log.Fatal(err)
</span><span id="__span-44-94"><a id="__codelineno-44-94" name="__codelineno-44-94"></a>    }
</span><span id="__span-44-95"><a id="__codelineno-44-95" name="__codelineno-44-95"></a>
</span><span id="__span-44-96"><a id="__codelineno-44-96" name="__codelineno-44-96"></a>    _, err = db.Model(&amp;Employee{
</span><span id="__span-44-97"><a id="__codelineno-44-97" name="__codelineno-44-97"></a>        Name:      &quot;Kelly&quot;,
</span><span id="__span-44-98"><a id="__codelineno-44-98" name="__codelineno-44-98"></a>        Age:       35,
</span><span id="__span-44-99"><a id="__codelineno-44-99" name="__codelineno-44-99"></a>        Language:  []string{&quot;Golang&quot;, &quot;Python&quot;},
</span><span id="__span-44-100"><a id="__codelineno-44-100" name="__codelineno-44-100"></a>    }).Insert()
</span><span id="__span-44-101"><a id="__codelineno-44-101" name="__codelineno-44-101"></a>    if err != nil {
</span><span id="__span-44-102"><a id="__codelineno-44-102" name="__codelineno-44-102"></a>        log.Fatal(err)
</span><span id="__span-44-103"><a id="__codelineno-44-103" name="__codelineno-44-103"></a>    }
</span><span id="__span-44-104"><a id="__codelineno-44-104" name="__codelineno-44-104"></a>
</span><span id="__span-44-105"><a id="__codelineno-44-105" name="__codelineno-44-105"></a>    fmt.Println(&quot;Inserted data&quot;)
</span><span id="__span-44-106"><a id="__codelineno-44-106" name="__codelineno-44-106"></a>
</span><span id="__span-44-107"><a id="__codelineno-44-107" name="__codelineno-44-107"></a>    // Read from the table using the Select() function.
</span><span id="__span-44-108"><a id="__codelineno-44-108" name="__codelineno-44-108"></a>    emp := new(Employee)
</span><span id="__span-44-109"><a id="__codelineno-44-109" name="__codelineno-44-109"></a>    err = db.Model(emp).
</span><span id="__span-44-110"><a id="__codelineno-44-110" name="__codelineno-44-110"></a>        Where(&quot;employee.id = ?&quot;, employee1.Id).
</span><span id="__span-44-111"><a id="__codelineno-44-111" name="__codelineno-44-111"></a>        Select()
</span><span id="__span-44-112"><a id="__codelineno-44-112" name="__codelineno-44-112"></a>    if err != nil {
</span><span id="__span-44-113"><a id="__codelineno-44-113" name="__codelineno-44-113"></a>        log.Fatal(err)
</span><span id="__span-44-114"><a id="__codelineno-44-114" name="__codelineno-44-114"></a>    }
</span><span id="__span-44-115"><a id="__codelineno-44-115" name="__codelineno-44-115"></a>    fmt.Printf(&quot;Query for id=1 returned: &quot;);
</span><span id="__span-44-116"><a id="__codelineno-44-116" name="__codelineno-44-116"></a>    fmt.Println(emp)
</span><span id="__span-44-117"><a id="__codelineno-44-117" name="__codelineno-44-117"></a>}
</span></code></pre></div></td></tr></table></div>
<p>1） Using pg.Options()</p>
<p>如果密码包含这些特殊字符（#、%、^），则驱动程序可能无法解析URL。在这种情况下，请使用pg.Options()而不是pg.ParseURL()来初始化sqlsh_hello_world.go中的Options。除了PGPASSWORD和PGSSLROOTCERT之外的标准PG环境变量由驱动程序隐式读取。按如下方式设置PG变量：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span>
<span class="normal"><a href="#__codelineno-45-2">2</a></span>
<span class="normal"><a href="#__codelineno-45-3">3</a></span>
<span class="normal"><a href="#__codelineno-45-4">4</a></span>
<span class="normal"><a href="#__codelineno-45-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a>export PGHOST=127.0.0.1
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2"></a>export PGPORT=2521
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3"></a>export PGUSER=bigmath
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4"></a>export PGPASSWORD=password#with%special^chars
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5"></a>export PGDATABASE=bigmath
</span></code></pre></div></td></tr></table></div>
<p>要使用pg.Options()，请将文件中的主函数替换为以下内容： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-46-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-46-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-46-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-46-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-46-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-46-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-46-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-46-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-46-10">10</a></span>
<span class="normal"><a href="#__codelineno-46-11">11</a></span>
<span class="normal"><a href="#__codelineno-46-12">12</a></span>
<span class="normal"><a href="#__codelineno-46-13">13</a></span>
<span class="normal"><a href="#__codelineno-46-14">14</a></span>
<span class="normal"><a href="#__codelineno-46-15">15</a></span>
<span class="normal"><a href="#__codelineno-46-16">16</a></span>
<span class="normal"><a href="#__codelineno-46-17">17</a></span>
<span class="normal"><a href="#__codelineno-46-18">18</a></span>
<span class="normal"><a href="#__codelineno-46-19">19</a></span>
<span class="normal"><a href="#__codelineno-46-20">20</a></span>
<span class="normal"><a href="#__codelineno-46-21">21</a></span>
<span class="normal"><a href="#__codelineno-46-22">22</a></span>
<span class="normal"><a href="#__codelineno-46-23">23</a></span>
<span class="normal"><a href="#__codelineno-46-24">24</a></span>
<span class="normal"><a href="#__codelineno-46-25">25</a></span>
<span class="normal"><a href="#__codelineno-46-26">26</a></span>
<span class="normal"><a href="#__codelineno-46-27">27</a></span>
<span class="normal"><a href="#__codelineno-46-28">28</a></span>
<span class="normal"><a href="#__codelineno-46-29">29</a></span>
<span class="normal"><a href="#__codelineno-46-30">30</a></span>
<span class="normal"><a href="#__codelineno-46-31">31</a></span>
<span class="normal"><a href="#__codelineno-46-32">32</a></span>
<span class="normal"><a href="#__codelineno-46-33">33</a></span>
<span class="normal"><a href="#__codelineno-46-34">34</a></span>
<span class="normal"><a href="#__codelineno-46-35">35</a></span>
<span class="normal"><a href="#__codelineno-46-36">36</a></span>
<span class="normal"><a href="#__codelineno-46-37">37</a></span>
<span class="normal"><a href="#__codelineno-46-38">38</a></span>
<span class="normal"><a href="#__codelineno-46-39">39</a></span>
<span class="normal"><a href="#__codelineno-46-40">40</a></span>
<span class="normal"><a href="#__codelineno-46-41">41</a></span>
<span class="normal"><a href="#__codelineno-46-42">42</a></span>
<span class="normal"><a href="#__codelineno-46-43">43</a></span>
<span class="normal"><a href="#__codelineno-46-44">44</a></span>
<span class="normal"><a href="#__codelineno-46-45">45</a></span>
<span class="normal"><a href="#__codelineno-46-46">46</a></span>
<span class="normal"><a href="#__codelineno-46-47">47</a></span>
<span class="normal"><a href="#__codelineno-46-48">48</a></span>
<span class="normal"><a href="#__codelineno-46-49">49</a></span>
<span class="normal"><a href="#__codelineno-46-50">50</a></span>
<span class="normal"><a href="#__codelineno-46-51">51</a></span>
<span class="normal"><a href="#__codelineno-46-52">52</a></span>
<span class="normal"><a href="#__codelineno-46-53">53</a></span>
<span class="normal"><a href="#__codelineno-46-54">54</a></span>
<span class="normal"><a href="#__codelineno-46-55">55</a></span>
<span class="normal"><a href="#__codelineno-46-56">56</a></span>
<span class="normal"><a href="#__codelineno-46-57">57</a></span>
<span class="normal"><a href="#__codelineno-46-58">58</a></span>
<span class="normal"><a href="#__codelineno-46-59">59</a></span>
<span class="normal"><a href="#__codelineno-46-60">60</a></span>
<span class="normal"><a href="#__codelineno-46-61">61</a></span>
<span class="normal"><a href="#__codelineno-46-62">62</a></span>
<span class="normal"><a href="#__codelineno-46-63">63</a></span>
<span class="normal"><a href="#__codelineno-46-64">64</a></span>
<span class="normal"><a href="#__codelineno-46-65">65</a></span>
<span class="normal"><a href="#__codelineno-46-66">66</a></span>
<span class="normal"><a href="#__codelineno-46-67">67</a></span>
<span class="normal"><a href="#__codelineno-46-68">68</a></span>
<span class="normal"><a href="#__codelineno-46-69">69</a></span>
<span class="normal"><a href="#__codelineno-46-70">70</a></span>
<span class="normal"><a href="#__codelineno-46-71">71</a></span>
<span class="normal"><a href="#__codelineno-46-72">72</a></span>
<span class="normal"><a href="#__codelineno-46-73">73</a></span>
<span class="normal"><a href="#__codelineno-46-74">74</a></span>
<span class="normal"><a href="#__codelineno-46-75">75</a></span>
<span class="normal"><a href="#__codelineno-46-76">76</a></span>
<span class="normal"><a href="#__codelineno-46-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1"></a>/* Modify the main() from the sqlsh_hello_world.go script by replacing the first few lines and enabling pg.Options() */
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2"></a>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3"></a>func main() {
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4"></a>    opt := &amp;pg.Options{
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5"></a>        Password: os.Getenv(&quot;PGPASSWORD&quot;),
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6"></a>    }
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7"></a>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8"></a>    CAFile := os.Getenv(&quot;PGSSLROOTCERT&quot;)
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9"></a>    if (CAFile != &quot;&quot;) {
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10"></a>        CACert, err2 := ioutil.ReadFile(CAFile)
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11"></a>        if err2 != nil {
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12"></a>            log.Fatal(err2)
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13"></a>        }
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14"></a>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15"></a>        CACertPool := x509.NewCertPool()
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16"></a>        CACertPool.AppendCertsFromPEM(CACert)
</span><span id="__span-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17"></a>
</span><span id="__span-46-18"><a id="__codelineno-46-18" name="__codelineno-46-18"></a>        tlsConfig := &amp;tls.Config{
</span><span id="__span-46-19"><a id="__codelineno-46-19" name="__codelineno-46-19"></a>          RootCAs:            CACertPool,
</span><span id="__span-46-20"><a id="__codelineno-46-20" name="__codelineno-46-20"></a>          ServerName:         host,
</span><span id="__span-46-21"><a id="__codelineno-46-21" name="__codelineno-46-21"></a>        }
</span><span id="__span-46-22"><a id="__codelineno-46-22" name="__codelineno-46-22"></a>        opt.TLSConfig = tlsConfig
</span><span id="__span-46-23"><a id="__codelineno-46-23" name="__codelineno-46-23"></a>    }
</span><span id="__span-46-24"><a id="__codelineno-46-24" name="__codelineno-46-24"></a>    db := pg.Connect(opt)
</span><span id="__span-46-25"><a id="__codelineno-46-25" name="__codelineno-46-25"></a>
</span><span id="__span-46-26"><a id="__codelineno-46-26" name="__codelineno-46-26"></a>    defer db.Close()
</span><span id="__span-46-27"><a id="__codelineno-46-27" name="__codelineno-46-27"></a>
</span><span id="__span-46-28"><a id="__codelineno-46-28" name="__codelineno-46-28"></a>    model := (*Employee)(nil)
</span><span id="__span-46-29"><a id="__codelineno-46-29" name="__codelineno-46-29"></a>    err := db.Model(model).DropTable(&amp;orm.DropTableOptions{
</span><span id="__span-46-30"><a id="__codelineno-46-30" name="__codelineno-46-30"></a>        IfExists: true,
</span><span id="__span-46-31"><a id="__codelineno-46-31" name="__codelineno-46-31"></a>    })
</span><span id="__span-46-32"><a id="__codelineno-46-32" name="__codelineno-46-32"></a>    if err != nil {
</span><span id="__span-46-33"><a id="__codelineno-46-33" name="__codelineno-46-33"></a>        log.Fatal(err)
</span><span id="__span-46-34"><a id="__codelineno-46-34" name="__codelineno-46-34"></a>    }
</span><span id="__span-46-35"><a id="__codelineno-46-35" name="__codelineno-46-35"></a>
</span><span id="__span-46-36"><a id="__codelineno-46-36" name="__codelineno-46-36"></a>    err = db.Model(model).CreateTable(&amp;orm.CreateTableOptions{
</span><span id="__span-46-37"><a id="__codelineno-46-37" name="__codelineno-46-37"></a>        Temp: false,
</span><span id="__span-46-38"><a id="__codelineno-46-38" name="__codelineno-46-38"></a>    })
</span><span id="__span-46-39"><a id="__codelineno-46-39" name="__codelineno-46-39"></a>    if err != nil {
</span><span id="__span-46-40"><a id="__codelineno-46-40" name="__codelineno-46-40"></a>        log.Fatal(err)
</span><span id="__span-46-41"><a id="__codelineno-46-41" name="__codelineno-46-41"></a>    }
</span><span id="__span-46-42"><a id="__codelineno-46-42" name="__codelineno-46-42"></a>
</span><span id="__span-46-43"><a id="__codelineno-46-43" name="__codelineno-46-43"></a>    fmt.Println(&quot;Created table&quot;)
</span><span id="__span-46-44"><a id="__codelineno-46-44" name="__codelineno-46-44"></a>
</span><span id="__span-46-45"><a id="__codelineno-46-45" name="__codelineno-46-45"></a>    // Insert into the table.
</span><span id="__span-46-46"><a id="__codelineno-46-46" name="__codelineno-46-46"></a>    employee1 := &amp;Employee{
</span><span id="__span-46-47"><a id="__codelineno-46-47" name="__codelineno-46-47"></a>        Name:   &quot;John&quot;,
</span><span id="__span-46-48"><a id="__codelineno-46-48" name="__codelineno-46-48"></a>        Age:    35,
</span><span id="__span-46-49"><a id="__codelineno-46-49" name="__codelineno-46-49"></a>        Language: []string{&quot;Go&quot;},
</span><span id="__span-46-50"><a id="__codelineno-46-50" name="__codelineno-46-50"></a>    }
</span><span id="__span-46-51"><a id="__codelineno-46-51" name="__codelineno-46-51"></a>    _, err = db.Model(employee1).Insert()
</span><span id="__span-46-52"><a id="__codelineno-46-52" name="__codelineno-46-52"></a>    if err != nil {
</span><span id="__span-46-53"><a id="__codelineno-46-53" name="__codelineno-46-53"></a>        log.Fatal(err)
</span><span id="__span-46-54"><a id="__codelineno-46-54" name="__codelineno-46-54"></a>    }
</span><span id="__span-46-55"><a id="__codelineno-46-55" name="__codelineno-46-55"></a>
</span><span id="__span-46-56"><a id="__codelineno-46-56" name="__codelineno-46-56"></a>    _, err = db.Model(&amp;Employee{
</span><span id="__span-46-57"><a id="__codelineno-46-57" name="__codelineno-46-57"></a>        Name:      &quot;Kelly&quot;,
</span><span id="__span-46-58"><a id="__codelineno-46-58" name="__codelineno-46-58"></a>        Age:       35,
</span><span id="__span-46-59"><a id="__codelineno-46-59" name="__codelineno-46-59"></a>        Language:  []string{&quot;Golang&quot;, &quot;Python&quot;},
</span><span id="__span-46-60"><a id="__codelineno-46-60" name="__codelineno-46-60"></a>    }).Insert()
</span><span id="__span-46-61"><a id="__codelineno-46-61" name="__codelineno-46-61"></a>    if err != nil {
</span><span id="__span-46-62"><a id="__codelineno-46-62" name="__codelineno-46-62"></a>        log.Fatal(err)
</span><span id="__span-46-63"><a id="__codelineno-46-63" name="__codelineno-46-63"></a>    }
</span><span id="__span-46-64"><a id="__codelineno-46-64" name="__codelineno-46-64"></a>
</span><span id="__span-46-65"><a id="__codelineno-46-65" name="__codelineno-46-65"></a>    fmt.Println(&quot;Inserted data&quot;)
</span><span id="__span-46-66"><a id="__codelineno-46-66" name="__codelineno-46-66"></a>
</span><span id="__span-46-67"><a id="__codelineno-46-67" name="__codelineno-46-67"></a>    // Read from the table.
</span><span id="__span-46-68"><a id="__codelineno-46-68" name="__codelineno-46-68"></a>    emp := new(Employee)
</span><span id="__span-46-69"><a id="__codelineno-46-69" name="__codelineno-46-69"></a>    err = db.Model(emp).
</span><span id="__span-46-70"><a id="__codelineno-46-70" name="__codelineno-46-70"></a>        Where(&quot;employee.id = ?&quot;, employee1.Id).
</span><span id="__span-46-71"><a id="__codelineno-46-71" name="__codelineno-46-71"></a>        Select()
</span><span id="__span-46-72"><a id="__codelineno-46-72" name="__codelineno-46-72"></a>    if err != nil {
</span><span id="__span-46-73"><a id="__codelineno-46-73" name="__codelineno-46-73"></a>        log.Fatal(err)
</span><span id="__span-46-74"><a id="__codelineno-46-74" name="__codelineno-46-74"></a>    }
</span><span id="__span-46-75"><a id="__codelineno-46-75" name="__codelineno-46-75"></a>    fmt.Printf(&quot;Query for id=1 returned: &quot;);
</span><span id="__span-46-76"><a id="__codelineno-46-76" name="__codelineno-46-76"></a>    fmt.Println(emp)
</span><span id="__span-46-77"><a id="__codelineno-46-77" name="__codelineno-46-77"></a>}
</span></code></pre></div></td></tr></table></div>
<p>2）运行应用程序</p>
<p>使用以下命令运行应用程序： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1"></a>go run sqlsh_hello_world.go
</span></code></pre></div></td></tr></table></div>
<p>您应该看到类似于以下内容的输出：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span>
<span class="normal"><a href="#__codelineno-48-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1"></a>Created table
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2"></a>Inserted data
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3"></a>Query for id=1 returned: Employee&lt;1 John 35 [%!l(string=Go)]&gt;
</span></code></pre></div></td></tr></table></div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="Java.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: Java">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                Java
              </div>
            </div>
          </a>
        
        
          
          <a href="Python.html" class="md-footer__link md-footer__link--next" aria-label="下一页: Python">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Python
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2023 - 2024 贝格迈思（深圳）技术有限公司 粤ICP备17054434号-1
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/as599397086/BMDOC" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
  </body>
</html>